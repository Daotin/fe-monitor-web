{"version":3,"file":"index-CqtnxJ52.js","sources":["../../../src/api/request.ts","../../../src/api/index.ts"],"sourcesContent":["import axios, { type AxiosRequestConfig, type AxiosResponse } from 'axios'\nimport { ElMessage } from 'element-plus'\n\n// 创建axios实例\nconst service = axios.create({\n\tbaseURL: '/api/v1', // API基础URL\n\ttimeout: 15000, // 请求超时时间\n})\n\n// 请求拦截器\nservice.interceptors.request.use(\n\tconfig => {\n\t\t// 在发送请求之前做些什么\n\t\tconsole.log('发送请求:', config.url)\n\t\treturn config\n\t},\n\terror => {\n\t\t// 对请求错误做些什么\n\t\tconsole.error('请求错误:', error)\n\t\treturn Promise.reject(error)\n\t},\n)\n\n// 响应拦截器\nservice.interceptors.response.use(\n\t(response: AxiosResponse) => {\n\t\tconst res = response.data\n\t\tconsole.log('接收响应:', response.config.url, res)\n\n\t\t// 如果是文件下载等二进制数据，直接返回\n\t\tif (response.request.responseType === 'blob' || response.request.responseType === 'arraybuffer') {\n\t\t\treturn response\n\t\t}\n\n\t\t// 正常响应直接返回数据\n\t\treturn res\n\t},\n\terror => {\n\t\tconsole.error('响应错误:', error)\n\n\t\t// 处理错误响应\n\t\tconst { response } = error\n\t\tif (response) {\n\t\t\tconst { status, data } = response\n\t\t\tlet message = '未知错误'\n\n\t\t\tif (data && data.message) {\n\t\t\t\tmessage = data.message\n\t\t\t} else {\n\t\t\t\tswitch (status) {\n\t\t\t\t\tcase 400:\n\t\t\t\t\t\tmessage = '请求错误'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 401:\n\t\t\t\t\t\tmessage = '未授权，请重新登录'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 403:\n\t\t\t\t\t\tmessage = '拒绝访问'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 404:\n\t\t\t\t\t\tmessage = '请求地址出错'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 408:\n\t\t\t\t\t\tmessage = '请求超时'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 500:\n\t\t\t\t\t\tmessage = '服务器内部错误'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 501:\n\t\t\t\t\t\tmessage = '服务未实现'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 502:\n\t\t\t\t\t\tmessage = '网关错误'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 503:\n\t\t\t\t\t\tmessage = '服务不可用'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 504:\n\t\t\t\t\t\tmessage = '网关超时'\n\t\t\t\t\t\tbreak\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmessage = `未知错误(${status})`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tElMessage.error(message)\n\t\t} else {\n\t\t\tElMessage.error('网络异常，请检查您的网络连接')\n\t\t}\n\n\t\treturn Promise.reject(error)\n\t},\n)\n\n// 封装GET请求\nexport function get<T>(url: string, params?: any, config?: AxiosRequestConfig): Promise<T> {\n\treturn service.get(url, { params, ...config })\n}\n\n// 封装POST请求\nexport function post<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> {\n\treturn service.post(url, data, config)\n}\n\n// 封装PUT请求\nexport function put<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> {\n\treturn service.put(url, data, config)\n}\n\n// 封装DELETE请求\nexport function del<T>(url: string, params?: any, config?: AxiosRequestConfig): Promise<T> {\n\treturn service.delete(url, { params, ...config })\n}\n\nexport default service\n","import { get, post } from './request'\n\n// 接口返回类型定义\nexport interface StatsResponse {\n\tpvCount: number\n\tuvCount: number\n\tjsErrorCount: number\n\tlcpAvg: number\n}\n\nexport interface ErrorTrendItem {\n\tdate: string\n\tcount: number\n}\n\nexport interface ErrorItem {\n\tfingerprint: string\n\tmessage: string\n\ttype: string\n\tcount: number\n\tuserCount: number\n\tfirstSeen: string\n\tlastSeen: string\n\tsampleEventId: string\n}\n\nexport interface ErrorListResponse {\n\titems: ErrorItem[]\n\ttotal: number\n}\n\nexport interface PerformanceSummary {\n\tlcp: {\n\t\tavg: number\n\t\tp75: number\n\t}\n\tfcp: {\n\t\tavg: number\n\t\tp75: number\n\t}\n}\n\nexport interface SlowPage {\n\turl: string\n\tvalue: number\n}\n\nexport interface ResourceError {\n\teventId: string\n\turl: string\n\ttype: string\n\ttagName: string\n\tstatus: number | null\n\ttimestamp: string\n}\n\nexport interface SourceMapFile {\n\tid: string\n\tappId: string\n\tfileName: string\n\toriginalFileName: string\n\tversion: string\n\tsize: number\n\tuploadTime: string\n\tstatus: 'active' | 'inactive'\n}\n\nexport interface UploadSourceMapResponse {\n\tsuccess: boolean\n\tid: string\n\tfileName: string\n\tuploadTime: string\n}\n\nexport interface EventDetail {\n\tid: string\n\tappId: string\n\tuserId: string\n\ttype: string\n\tsubType: string\n\ttimestamp: string\n\tpayload: {\n\t\tmessage: string\n\t\tstack: string\n\t\tparsedStack?: Array<{\n\t\t\tfile: string\n\t\t\tline: number\n\t\t\tcolumn: number\n\t\t\tfunc: string\n\t\t}>\n\t\tmeta: {\n\t\t\turl: string\n\t\t\tbrowser: string\n\t\t\tos: string\n\t\t\tdevice: string\n\t\t\t[key: string]: any\n\t\t}\n\t\tbehaviorStack?: Array<{\n\t\t\ttype: string\n\t\t\t[key: string]: any\n\t\t\ttimestamp: number\n\t\t}>\n\t\trrwebData?: Array<{\n\t\t\ttype: number\n\t\t\tdata: any\n\t\t\ttimestamp: number\n\t\t}>\n\t}\n\tcreatedAt: string\n}\n\n// API接口函数\n\n// 获取概览页的核心统计指标\nexport function getStats(appId: string, startTime: string, endTime: string) {\n\treturn get<StatsResponse>('/stats/summarize', { appId, startTime, endTime })\n}\n\n// 获取JS错误数量的时间趋势数据\nexport function getErrorTrend(appId: string, startTime: string, endTime: string, interval: string = 'day') {\n\treturn get<ErrorTrendItem[]>('/stats/error-trend', { appId, startTime, endTime, interval })\n}\n\n// 获取聚合后的JS错误列表\nexport function getErrors(\n\tappId: string,\n\tstartTime: string,\n\tendTime: string,\n\tpage: number = 1,\n\tlimit: number = 20,\n\tsortBy: string = 'lastSeen_desc',\n) {\n\treturn get<ErrorListResponse>('/stats/errors', { appId, startTime, endTime, page, limit, sortBy })\n}\n\n// 获取单个事件实例的详细信息\nexport function getEventDetail(eventId: string) {\n\treturn get<EventDetail>(`/events/${eventId}`)\n}\n\n// 获取核心Web Vitals性能指标概览\nexport function getPerformanceSummary(appId: string, startTime: string, endTime: string) {\n\treturn get<PerformanceSummary>('/performance/summary', { appId, startTime, endTime })\n}\n\n// 获取加载最慢的页面列表\nexport function getSlowPages(\n\tappId: string,\n\tstartTime: string,\n\tendTime: string,\n\tmetric: string = 'lcp',\n\tlimit: number = 5,\n) {\n\treturn get<SlowPage[]>('/performance/slow-pages', { appId, startTime, endTime, metric, limit })\n}\n\n// 获取资源加载错误列表\nexport function getResourceErrors(appId: string, startTime: string, endTime: string, limit: number = 20) {\n\treturn get<ResourceError[]>('/performance/resource-errors', { appId, startTime, endTime, limit })\n}\n\n// 获取SourceMap文件列表\nexport function getSourceMaps(appId: string) {\n\treturn get<SourceMapFile[]>('/sourcemaps', { appId })\n}\n\n// 上传SourceMap文件\nexport function uploadSourceMap(appId: string, file: File, version: string) {\n\tconst formData = new FormData()\n\tformData.append('file', file)\n\tformData.append('appId', appId)\n\tformData.append('version', version)\n\n\treturn post<UploadSourceMapResponse>('/sourcemaps/upload', formData, {\n\t\theaders: {\n\t\t\t'Content-Type': 'multipart/form-data',\n\t\t},\n\t})\n}\n\n// 删除SourceMap文件\nexport function deleteSourceMap(fileId: string) {\n\treturn post<{ success: boolean; id: string }>(\n\t\t`/sourcemaps/${fileId}`,\n\t\t{},\n\t\t{\n\t\t\tmethod: 'DELETE',\n\t\t},\n\t)\n}\n"],"names":["service","axios","config","error","response","res","status","data","message","ElMessage","get","url","params","post","getStats","appId","startTime","endTime","getErrorTrend","interval","getErrors","page","limit","sortBy","getEventDetail","eventId","getPerformanceSummary","getSlowPages","metric","getResourceErrors","getSourceMaps","uploadSourceMap","file","version","formData","deleteSourceMap","fileId"],"mappings":"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"}