import{u as An}from"./app-CZDtxeHb.js";import{u as so,c as Rt,b as io}from"./index-Cn3Jm4lI.js";import{T as ao}from"./TimeRangeSelector-Cfj0Vkmg.js";import{d as $e,G as lo,y as Ie,b as ae,f as D,r as W,w as M,o as j,F as Oe,g as Xe,k as be,l as H,c as Re,h as De,H as ht,I as pt,e as V,m as wn,J as co,t as ie,n as uo,D as Ce,s as Sn,z as ho,i as wt,A as po,C as go}from"./index-DEoX-3sF.js";import{_ as Ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const mo={class:"error-filter"},fo=$e({__name:"ErrorFilter",props:{errorType:{default:""},sortBy:{default:"lastSeen_desc"}},emits:["update:errorType","update:sortBy","refresh"],setup(t,{emit:e}){const n=[{value:"",label:"全部类型"},{value:"TypeError",label:"TypeError"},{value:"ReferenceError",label:"ReferenceError"},{value:"SyntaxError",label:"SyntaxError"},{value:"RangeError",label:"RangeError"},{value:"URIError",label:"URIError"},{value:"EvalError",label:"EvalError"},{value:"InternalError",label:"InternalError"}],o=[{value:"lastSeen_desc",label:"最近发生"},{value:"count_desc",label:"发生次数 (多到少)"},{value:"count_asc",label:"发生次数 (少到多)"},{value:"userCount_desc",label:"影响用户数 (多到少)"},{value:"userCount_asc",label:"影响用户数 (少到多)"},{value:"firstSeen_desc",label:"首次发生 (新到旧)"},{value:"firstSeen_asc",label:"首次发生 (旧到新)"}],r=t,i=e,s=An(),a=lo({errorType:r.errorType,sortBy:r.sortBy});Ie(()=>r.errorType,h=>{a.errorType=h}),Ie(()=>r.sortBy,h=>{a.sortBy=h});const l=h=>{i("update:errorType",h),i("refresh")},u=h=>{i("update:sortBy",h),i("refresh")},c=h=>{s.setTimeRange(h),console.log("时间范围变化:",h)},d=()=>{console.log("手动刷新数据"),i("refresh")};return(h,f)=>{const p=W("el-form-item"),g=W("el-col"),C=W("el-option"),m=W("el-select"),v=W("Refresh"),E=W("el-icon"),A=W("el-button"),T=W("el-row"),O=W("el-form"),F=W("el-card");return j(),ae("div",mo,[D(F,{shadow:"never",class:"filter-card"},{default:M(()=>[D(O,{model:a,"label-position":"left",class:"filter-form"},{default:M(()=>[D(T,{gutter:20},{default:M(()=>[D(g,{xs:24,sm:24,md:12,lg:12,xl:12},{default:M(()=>[D(p,{label:"时间范围"},{default:M(()=>[D(ao,{onChange:c})]),_:1})]),_:1}),D(g,{xs:24,sm:12,md:6,lg:4,xl:4},{default:M(()=>[D(p,{label:"错误类型"},{default:M(()=>[D(m,{modelValue:a.errorType,"onUpdate:modelValue":f[0]||(f[0]=N=>a.errorType=N),placeholder:"错误类型",clearable:"",onChange:l,class:"full-width"},{default:M(()=>[(j(),ae(Oe,null,Xe(n,N=>D(C,{key:N.value,label:N.label,value:N.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),D(g,{xs:24,sm:12,md:6,lg:4,xl:4},{default:M(()=>[D(p,{label:"排序方式"},{default:M(()=>[D(m,{modelValue:a.sortBy,"onUpdate:modelValue":f[1]||(f[1]=N=>a.sortBy=N),placeholder:"排序方式",onChange:u,class:"full-width"},{default:M(()=>[(j(),ae(Oe,null,Xe(o,N=>D(C,{key:N.value,label:N.label,value:N.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),D(g,{xs:24,sm:24,md:24,lg:4,xl:4,class:"action-col"},{default:M(()=>[D(p,{label:"",class:"button-form-item"},{default:M(()=>[D(A,{type:"primary",onClick:d,class:"refresh-button"},{default:M(()=>[D(E,null,{default:M(()=>[D(v)]),_:1}),f[2]||(f[2]=be(" 刷新 "))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),vo=Ue(fo,[["__scopeId","data-v-26ba08e7"]]),yo={key:0,class:"upload-section"},Co={class:"upload-tip"},Io={class:"upload-area"},bo={class:"stack-section"},Ao={class:"original-stack"},wo={key:1,class:"parsed-stack-section"},So={class:"parsed-stack"},Eo={class:"frame-number"},No={class:"frame-content"},To={class:"frame-function"},Do={class:"frame-location"},_o={class:"line-column"},Mo={class:"source-code-preview"},Ro={class:"line-number"},ko={class:"code-content"},xo=$e({__name:"SourceCodeDialog",props:{visible:{type:Boolean},errorId:{}},emits:["update:visible"],setup(t,{emit:e}){const n=t,o=e,r=H(null),i=H(!1),s=H(!1),a=H(!1),l=H(null),u=Re(()=>{var m;return((m=r.value)==null?void 0:m.payload.parsedStack)&&r.value.payload.parsedStack.length>0}),c=Re(()=>{var m;return((m=r.value)==null?void 0:m.payload.stack)||"无堆栈信息"}),d=()=>{o("update:visible",!1)},h=async()=>{if(n.errorId)try{i.value=!0,console.log("获取错误详情数据，错误ID:",n.errorId);const m=await Rt(n.errorId);r.value=m,console.log("错误详情数据:",m)}catch(m){console.error("获取错误详情数据失败:",m),Ce.error("获取错误详情数据失败")}finally{i.value=!1}},f=m=>{const v=m.split("/");return v[v.length-1]},p=m=>{if(!r.value||m.startsWith("http"))return m;try{const v=new URL(r.value.payload.meta.url);return new URL(m,v.origin).href}catch{return m}},g=(m,v)=>{l.value=m},C=async()=>{if(!l.value||!l.value.raw){Ce.warning("请先选择SourceMap文件");return}if(!r.value){Ce.warning("错误详情数据不存在");return}try{s.value=!0,await so(r.value.appId,l.value.raw,"1.0.0"),Ce.success("SourceMap上传成功"),a.value=!0,await h()}catch(m){console.error("上传SourceMap失败:",m),Ce.error("上传SourceMap失败")}finally{s.value=!1}};return Ie(()=>n.visible,m=>{m&&n.errorId&&h()}),(m,v)=>{const E=W("el-alert"),A=W("el-button"),T=W("el-link"),O=W("el-dialog"),F=pt("loading");return j(),De(O,{title:"错误源码详情",modelValue:n.visible,"onUpdate:modelValue":v[0]||(v[0]=N=>n.visible=N),width:"80%","destroy-on-close":"",onClose:d,class:"source-code-dialog"},{default:M(()=>{var N;return[ht((j(),ae("div",null,[u.value?(j(),ae("div",wo,[v[5]||(v[5]=V("h3",null,"解析后的错误堆栈",-1)),V("div",So,[(j(!0),ae(Oe,null,Xe((N=r.value)==null?void 0:N.payload.parsedStack,(b,x)=>(j(),ae("div",{key:x,class:"stack-frame"},[V("div",Eo,ie(x+1),1),V("div",No,[V("div",To,ie(b.func||"(匿名函数)"),1),V("div",Do,[D(T,{href:p(b.file),target:"_blank",underline:!1,class:"file-link"},{default:M(()=>[be(ie(f(b.file)),1)]),_:2},1032,["href"]),V("span",_o,":"+ie(b.line)+":"+ie(b.column),1)]),V("div",Mo,[(j(),ae(Oe,null,Xe(10,(w,y)=>V("div",{class:uo(["code-line",{"error-line":y===5}]),key:y},[V("span",Ro,ie(b.line-5+y),1),V("code",ko,ie(y===5?"// 这里是错误发生的行（实际内容需要从服务端获取）":"// 源码行 "+(b.line-5+y)),1)],2)),64))])])]))),128))])])):(j(),ae("div",yo,[V("div",Co,[D(E,{title:"需要上传SourceMap文件以查看源码",type:"info",description:"上传对应版本的SourceMap文件，系统将自动解析错误堆栈并显示源码","show-icon":"",closable:!1})]),V("div",Io,[D(wn(co),{class:"sourcemap-uploader",action:"#","auto-upload":!1,limit:1,accept:".map,.json","on-change":g},{tip:M(()=>v[2]||(v[2]=[V("div",{class:"el-upload__tip"},"请上传.map格式的SourceMap文件",-1)])),default:M(()=>[D(A,{type:"primary",loading:s.value},{default:M(()=>v[1]||(v[1]=[be("选择SourceMap文件")])),_:1},8,["loading"])]),_:1}),D(A,{type:"success",disabled:!l.value,loading:s.value,onClick:C},{default:M(()=>v[3]||(v[3]=[be(" 上传并解析 ")])),_:1},8,["disabled","loading"])]),V("div",bo,[v[4]||(v[4]=V("h3",null,"原始错误堆栈",-1)),V("pre",Ao,ie(c.value),1)])]))])),[[F,i.value]])]}),_:1},8,["modelValue"])}}}),Fo=Ue(xo,[["__scopeId","data-v-9ca6ce33"]]);function at(){}function $t(t,e){for(const n in e)t[n]=e[n];return t}function En(t){return t()}function Ut(){return Object.create(null)}function We(t){t.forEach(En)}function Bo(t){return typeof t=="function"}function kt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Wt(t){const e={};for(const n in t)n[0]!=="$"&&(e[n]=t[n]);return e}function P(t,e){t.appendChild(e)}function we(t,e,n){t.insertBefore(e,n||null)}function ve(t){t.parentNode.removeChild(t)}function mt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function re(t){return document.createElement(t)}function lt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ke(t){return document.createTextNode(t)}function ce(){return ke(" ")}function ze(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function k(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ct(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function ne(t,e,n,o){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function Ve(t,e,n){t.classList[n?"add":"remove"](e)}let je;function Qe(t){je=t}function gt(){if(!je)throw new Error("Function called outside component initialization");return je}function Nn(t){gt().$$.on_mount.push(t)}function Tn(t){gt().$$.on_destroy.push(t)}function Oo(){const t=gt();return(e,n,{cancelable:o=!1}={})=>{const r=t.$$.callbacks[e];if(r){const i=function(s,a,{bubbles:l=!1,cancelable:u=!1}={}){const c=document.createEvent("CustomEvent");return c.initCustomEvent(s,l,u,a),c}(e,n,{cancelable:o});return r.slice().forEach(s=>{s.call(t,i)}),!i.defaultPrevented}return!0}}const Pe=[],Ee=[],st=[],St=[],Vo=Promise.resolve();let Et=!1;function Nt(t){st.push(t)}const ft=new Set;let tt=0;function Dn(){const t=je;do{for(;tt<Pe.length;){const e=Pe[tt];tt++,Qe(e),Lo(e.$$)}for(Qe(null),Pe.length=0,tt=0;Ee.length;)Ee.pop()();for(let e=0;e<st.length;e+=1){const n=st[e];ft.has(n)||(ft.add(n),n())}st.length=0}while(Pe.length);for(;St.length;)St.pop()();Et=!1,ft.clear(),Qe(t)}function Lo(t){if(t.fragment!==null){t.update(),We(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Nt)}}const it=new Set;let Te;function _n(){Te={r:0,c:[],p:Te}}function Mn(){Te.r||We(Te.c),Te=Te.p}function Ae(t,e){t&&t.i&&(it.delete(t),t.i(e))}function Le(t,e,n,o){if(t&&t.o){if(it.has(t))return;it.add(t),Te.c.push(()=>{it.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function Rn(t){t&&t.c()}function xt(t,e,n,o){const{fragment:r,on_mount:i,on_destroy:s,after_update:a}=t.$$;r&&r.m(e,n),o||Nt(()=>{const l=i.map(En).filter(Bo);s?s.push(...l):We(l),t.$$.on_mount=[]}),a.forEach(Nt)}function Ft(t,e){const n=t.$$;n.fragment!==null&&(We(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function $o(t,e){t.$$.dirty[0]===-1&&(Pe.push(t),Et||(Et=!0,Vo.then(Dn)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Bt(t,e,n,o,r,i,s,a=[-1]){const l=je;Qe(t);const u=t.$$={fragment:null,ctx:null,props:i,update:at,not_equal:r,bound:Ut(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Ut(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};s&&s(u.root);let c=!1;if(u.ctx=n?n(t,e.props||{},(d,h,...f)=>{const p=f.length?f[0]:h;return u.ctx&&r(u.ctx[d],u.ctx[d]=p)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](p),c&&$o(t,d)),h}):[],u.update(),c=!0,We(u.before_update),u.fragment=!!o&&o(u.ctx),e.target){if(e.hydrate){const d=function(h){return Array.from(h.childNodes)}(e.target);u.fragment&&u.fragment.l(d),d.forEach(ve)}else u.fragment&&u.fragment.c();e.intro&&Ae(t.$$.fragment),xt(t,e.target,e.anchor,e.customElement),Dn()}Qe(l)}class Ot{$destroy(){Ft(this,1),this.$destroy=at}$on(e,n){const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){var n;this.$$set&&(n=e,Object.keys(n).length!==0)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var se;function Uo(t){return t.nodeType===t.ELEMENT_NODE}(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(se||(se={}));var kn=function(){function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return t.prototype.getId=function(e){var n;if(!e)return-1;var o=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return o??-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var n=this,o=this.getId(e);this.idNodeMap.delete(o),e.childNodes&&e.childNodes.forEach(function(r){return n.removeNodeFromMap(r)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,n){var o=n.id;this.idNodeMap.set(o,e),this.nodeMetaMap.set(e,n)},t.prototype.replace=function(e,n){var o=this.getNode(e);if(o){var r=this.nodeMetaMap.get(o);r&&this.nodeMetaMap.set(n,r)}this.idNodeMap.set(e,n)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},t}();function Wo(){return new kn}var Gt=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function Go(t,e){e===void 0&&(e={});var n=1,o=1;function r(w){var y=w.match(/\n/g);y&&(n+=y.length);var R=w.lastIndexOf(`
`);o=R===-1?o+w.length:w.length-R}function i(){var w={line:n,column:o};return function(y){return y.position=new s(w),f(),y}}var s=function(w){this.start=w,this.end={line:n,column:o},this.source=e.source};s.prototype.content=t;var a=[];function l(w){var y=new Error("".concat(e.source||"",":").concat(n,":").concat(o,": ").concat(w));if(y.reason=w,y.filename=e.source,y.line=n,y.column=o,y.source=t,!e.silent)throw y;a.push(y)}function u(){return h(/^{\s*/)}function c(){return h(/^}/)}function d(){var w,y=[];for(f(),p(y);t.length&&t.charAt(0)!=="}"&&(w=b()||x());)w!==!1&&(y.push(w),p(y));return y}function h(w){var y=w.exec(t);if(y){var R=y[0];return r(R),t=t.slice(R.length),y}}function f(){h(/^\s*/)}function p(w){var y;for(w===void 0&&(w=[]);y=g();)y!==!1&&w.push(y),y=g();return w}function g(){var w=i();if(t.charAt(0)==="/"&&t.charAt(1)==="*"){for(var y=2;t.charAt(y)!==""&&(t.charAt(y)!=="*"||t.charAt(y+1)!=="/");)++y;if(y+=2,t.charAt(y-1)==="")return l("End of comment missing");var R=t.slice(2,y-2);return o+=2,r(R),t=t.slice(y),o+=2,w({type:"comment",comment:R})}}function C(){var w=h(/^([^{]+)/);if(w)return ye(w[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(y){return y.replace(/,/g,"‌")}).split(/\s*(?![^(]*\)),\s*/).map(function(y){return y.replace(/\u200C/g,",")})}function m(){var w=i(),y=h(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(y){var R=ye(y[0]);if(!h(/^:\s*/))return l("property missing ':'");var _=h(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),Q=w({type:"declaration",property:R.replace(Gt,""),value:_?ye(_[0]).replace(Gt,""):""});return h(/^[;\s]*/),Q}}function v(){var w,y=[];if(!u())return l("missing '{'");for(p(y);w=m();)w!==!1&&(y.push(w),p(y)),w=m();return c()?y:l("missing '}'")}function E(){for(var w,y=[],R=i();w=h(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)y.push(w[1]),h(/^,\s*/);if(y.length)return R({type:"keyframe",values:y,declarations:v()})}var A,T=N("import"),O=N("charset"),F=N("namespace");function N(w){var y=new RegExp("^@"+w+"\\s*([^;]+);");return function(){var R=i(),_=h(y);if(_){var Q={type:w};return Q[w]=_[1].trim(),R(Q)}}}function b(){if(t[0]==="@")return function(){var w=i(),y=h(/^@([-\w]+)?keyframes\s*/);if(y){var R=y[1];if(!(y=h(/^([-\w]+)\s*/)))return l("@keyframes missing name");var _,Q=y[1];if(!u())return l("@keyframes missing '{'");for(var G=p();_=E();)G.push(_),G=G.concat(p());return c()?w({type:"keyframes",name:Q,vendor:R,keyframes:G}):l("@keyframes missing '}'")}}()||function(){var w=i(),y=h(/^@media *([^{]+)/);if(y){var R=ye(y[1]);if(!u())return l("@media missing '{'");var _=p().concat(d());return c()?w({type:"media",media:R,rules:_}):l("@media missing '}'")}}()||function(){var w=i(),y=h(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(y)return w({type:"custom-media",name:ye(y[1]),media:ye(y[2])})}()||function(){var w=i(),y=h(/^@supports *([^{]+)/);if(y){var R=ye(y[1]);if(!u())return l("@supports missing '{'");var _=p().concat(d());return c()?w({type:"supports",supports:R,rules:_}):l("@supports missing '}'")}}()||T()||O()||F()||function(){var w=i(),y=h(/^@([-\w]+)?document *([^{]+)/);if(y){var R=ye(y[1]),_=ye(y[2]);if(!u())return l("@document missing '{'");var Q=p().concat(d());return c()?w({type:"document",document:_,vendor:R,rules:Q}):l("@document missing '}'")}}()||function(){var w=i();if(h(/^@page */)){var y=C()||[];if(!u())return l("@page missing '{'");for(var R,_=p();R=m();)_.push(R),_=_.concat(p());return c()?w({type:"page",selectors:y,declarations:_}):l("@page missing '}'")}}()||function(){var w=i();if(h(/^@host\s*/)){if(!u())return l("@host missing '{'");var y=p().concat(d());return c()?w({type:"host",rules:y}):l("@host missing '}'")}}()||function(){var w=i();if(h(/^@font-face\s*/)){if(!u())return l("@font-face missing '{'");for(var y,R=p();y=m();)R.push(y),R=R.concat(p());return c()?w({type:"font-face",declarations:R}):l("@font-face missing '}'")}}()}function x(){var w=i(),y=C();return y?(p(),w({type:"rule",selectors:y,declarations:v()})):l("selector missing")}return Tt((A=d(),{type:"stylesheet",stylesheet:{source:e.source,rules:A,parsingErrors:a}}))}function ye(t){return t?t.replace(/^\s+|\s+$/g,""):""}function Tt(t,e){for(var n=t&&typeof t.type=="string",o=n?t:e,r=0,i=Object.keys(t);r<i.length;r++){var s=t[i[r]];Array.isArray(s)?s.forEach(function(a){Tt(a,o)}):s&&typeof s=="object"&&Tt(s,o)}return n&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:e||null}),t}var Zt={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"},xn=/([^\\]):hover/,Zo=new RegExp(xn.source,"g");function Pt(t,e){var n=e==null?void 0:e.stylesWithHoverClass.get(t);if(n)return n;var o=Go(t,{silent:!0});if(!o.stylesheet)return t;var r=[];if(o.stylesheet.rules.forEach(function(a){"selectors"in a&&(a.selectors||[]).forEach(function(l){xn.test(l)&&r.push(l)})}),r.length===0)return t;var i=new RegExp(r.filter(function(a,l){return r.indexOf(a)===l}).sort(function(a,l){return l.length-a.length}).map(function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|"),"g"),s=t.replace(i,function(a){var l=a.replace(Zo,"$1.\\:hover");return"".concat(a,", ").concat(l)});return e==null||e.stylesWithHoverClass.set(t,s),s}function Kt(){return{stylesWithHoverClass:new Map}}function Po(t,e){var n=e.doc,o=e.hackCss,r=e.cache;switch(t.type){case se.Document:return n.implementation.createDocument(null,"",null);case se.DocumentType:return n.implementation.createDocumentType(t.name||"html",t.publicId,t.systemId);case se.Element:var i,s=function(v){var E=Zt[v.tagName]?Zt[v.tagName]:v.tagName;return E==="link"&&v.attributes._cssText&&(E="style"),E}(t);i=t.isSVG?n.createElementNS("http://www.w3.org/2000/svg",s):n.createElement(s);var a={};for(var l in t.attributes)if(Object.prototype.hasOwnProperty.call(t.attributes,l)){var u=t.attributes[l];if(s!=="option"||l!=="selected"||u!==!1)if(u===!0&&(u=""),l.startsWith("rr_"))a[l]=u;else{var c=s==="textarea"&&l==="value",d=s==="style"&&l==="_cssText";if(d&&o&&typeof u=="string"&&(u=Pt(u,r)),!c&&!d||typeof u!="string")try{if(t.isSVG&&l==="xlink:href")i.setAttributeNS("http://www.w3.org/1999/xlink",l,u.toString());else if(l==="onload"||l==="onclick"||l.substring(0,7)==="onmouse")i.setAttribute("_"+l,u.toString());else{if(s==="meta"&&t.attributes["http-equiv"]==="Content-Security-Policy"&&l==="content"){i.setAttribute("csp-content",u.toString());continue}s==="link"&&t.attributes.rel==="preload"&&t.attributes.as==="script"||s==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")||(s==="img"&&t.attributes.srcset&&t.attributes.rr_dataURL?i.setAttribute("rrweb-original-srcset",t.attributes.srcset):i.setAttribute(l,u.toString()))}}catch{}else{for(var h=n.createTextNode(u),f=0,p=Array.from(i.childNodes);f<p.length;f++){var g=p[f];g.nodeType===i.TEXT_NODE&&i.removeChild(g)}i.appendChild(h)}}}var C=function(v){var E=a[v];if(s==="canvas"&&v==="rr_dataURL"){var A=document.createElement("img");A.onload=function(){var O=i.getContext("2d");O&&O.drawImage(A,0,0,A.width,A.height)},A.src=E.toString(),i.RRNodeType&&(i.rr_dataURL=E.toString())}else if(s==="img"&&v==="rr_dataURL"){var T=i;T.currentSrc.startsWith("data:")||(T.setAttribute("rrweb-original-src",t.attributes.src),T.src=E.toString())}if(v==="rr_width")i.style.width=E.toString();else if(v==="rr_height")i.style.height=E.toString();else if(v==="rr_mediaCurrentTime"&&typeof E=="number")i.currentTime=E;else if(v==="rr_mediaState")switch(E){case"played":i.play().catch(function(O){return console.warn("media playback error",O)});break;case"paused":i.pause()}};for(var m in a)C(m);if(t.isShadowHost)if(i.shadowRoot)for(;i.shadowRoot.firstChild;)i.shadowRoot.removeChild(i.shadowRoot.firstChild);else i.attachShadow({mode:"open"});return i;case se.Text:return n.createTextNode(t.isStyle&&o?Pt(t.textContent,r):t.textContent);case se.CDATA:return n.createCDATASection(t.textContent);case se.Comment:return n.createComment(t.textContent);default:return null}}function Je(t,e){var n=e.doc,o=e.mirror,r=e.skipChild,i=r!==void 0&&r,s=e.hackCss,a=s===void 0||s,l=e.afterAppend,u=e.cache,c=Po(t,{doc:n,hackCss:a,cache:u});if(!c)return null;if(t.rootId&&o.getNode(t.rootId)!==n&&o.replace(t.rootId,n),t.type===se.Document&&(n.close(),n.open(),t.compatMode==="BackCompat"&&t.childNodes&&t.childNodes[0].type!==se.DocumentType&&(t.childNodes[0].type===se.Element&&"xmlns"in t.childNodes[0].attributes&&t.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),c=n),o.add(c,t),(t.type===se.Document||t.type===se.Element)&&!i)for(var d=0,h=t.childNodes;d<h.length;d++){var f=h[d],p=Je(f,{doc:n,mirror:o,skipChild:!1,hackCss:a,afterAppend:l,cache:u});p?(f.isShadow&&Uo(c)&&c.shadowRoot?c.shadowRoot.appendChild(p):c.appendChild(p),l&&l(p,f.id)):console.warn("Failed to rebuild",f)}return c}function Ko(t,e){var n=e.doc,o=e.onVisit,r=e.hackCss,i=r===void 0||r,s=e.afterAppend,a=e.cache,l=e.mirror,u=l===void 0?new kn:l,c=Je(t,{doc:n,mirror:u,skipChild:!1,hackCss:i,afterAppend:s,cache:a});return function(d,h){for(var f=0,p=d.getIds();f<p.length;f++){var g=p[f];d.has(g)&&h(d.getNode(g))}}(u,function(d){o&&o(d),function(h,f){var p=f.getMeta(h);if((p==null?void 0:p.type)===se.Element){var g=h;for(var C in p.attributes)if(Object.prototype.hasOwnProperty.call(p.attributes,C)&&C.startsWith("rr_")){var m=p.attributes[C];C==="rr_scrollLeft"&&(g.scrollLeft=m),C==="rr_scrollTop"&&(g.scrollTop=m)}}}(d,u)}),c}const xe=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let Yt={map:{},getId:()=>(console.error(xe),-1),getNode:()=>(console.error(xe),null),removeNodeFromMap(){console.error(xe)},has:()=>(console.error(xe),!1),reset(){console.error(xe)}};function Yo(t){const e={},n=(r,i)=>{const s={value:r,parent:i,children:[]};return e[r.node.id]=s,s},o=[];for(const r of t){const{nextId:i,parentId:s}=r;if(i&&i in e){const a=e[i];if(a.parent){const l=a.parent.children.indexOf(a);a.parent.children.splice(l,0,n(r,a.parent))}else{const l=o.indexOf(a);o.splice(l,0,n(r,null))}}else if(s in e){const a=e[s];a.children.push(n(r,a))}else o.push(n(r,null))}return o}function Fn(t,e){e(t.value);for(let n=t.children.length-1;n>=0;n--)Fn(t.children[n],e)}function vt(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function Bn(t,e){var n,o;const r=(o=(n=t.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||o===void 0?void 0:o.frameElement;if(!r||r===e)return{x:0,y:0,relativeScale:1,absoluteScale:1};const i=r.getBoundingClientRect(),s=Bn(r,e),a=i.height/r.clientHeight;return{x:i.x*s.relativeScale+s.x,y:i.y*s.relativeScale+s.y,relativeScale:a,absoluteScale:s.absoluteScale*a}}function nt(t){return!!(t!=null&&t.shadowRoot)}function Ke(t,e){const n=t[e[0]];return e.length===1?n:Ke(n.cssRules[e[1]].cssRules,e.slice(2))}function zt(t){const e=[...t],n=e.pop();return{positions:e,index:n}}typeof window<"u"&&window.Proxy&&window.Reflect&&(Yt=new Proxy(Yt,{get:(t,e,n)=>(e==="map"&&console.error(xe),Reflect.get(t,e,n))}));class zo{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var n;return(n=this.styleIDMap.get(e))!==null&&n!==void 0?n:-1}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let o;return o=n===void 0?this.id++:n,this.styleIDMap.set(e,o),this.idStyleMap.set(o,e),o}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var J=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(J||{}),Z=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t))(Z||{}),le=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(le||{}),ut=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(ut||{}),Y=(t=>(t.Start="start",t.Pause="pause",t.Resume="resume",t.Resize="resize",t.Finish="finish",t.FullsnapshotRebuilded="fullsnapshot-rebuilded",t.LoadStylesheetStart="load-stylesheet-start",t.LoadStylesheetEnd="load-stylesheet-end",t.SkipStart="skip-start",t.SkipEnd="skip-end",t.MouseInteraction="mouse-interaction",t.EventCast="event-cast",t.CustomEvent="custom-event",t.Flush="flush",t.StateChange="state-change",t.PlayBack="play-back",t.Destroy="destroy",t))(Y||{});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function _e(t,e,n,o){return new(n||(n=Promise))(function(r,i){function s(u){try{l(o.next(u))}catch(c){i(c)}}function a(u){try{l(o.throw(u))}catch(c){i(c)}}function l(u){var c;u.done?r(u.value):(c=u.value,c instanceof n?c:new n(function(d){d(c)})).then(s,a)}l((o=o.apply(t,[])).next())})}for(var Qt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ye=typeof Uint8Array>"u"?[]:new Uint8Array(256),ot=0;ot<Qt.length;ot++)Ye[Qt.charCodeAt(ot)]=ot;var On=null;try{var Qo=typeof module<"u"&&typeof module.require=="function"&&module.require("worker_threads")||typeof __non_webpack_require__=="function"&&__non_webpack_require__("worker_threads")||typeof require=="function"&&require("worker_threads");On=Qo.Worker}catch{}function Jo(t,e,n){var o=e===void 0?null:e,r=function(a,l){return Buffer.from(a,"base64").toString(l?"utf16":"utf8")}(t,n!==void 0&&n),i=r.indexOf(`
`,10)+1,s=r.substring(i)+(o?"//# sourceMappingURL="+o:"");return function(a){return new On(s,Object.assign({},a,{eval:!0}))}}var Jt,Ht,Xt,U,Ho=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";Jt="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",Ht=null,Xt=!1,Ho&&Jo(Jt,Ht,Xt),function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"}(U||(U={}));var Xo=function(){function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return t.prototype.getId=function(e){var n;if(!e)return-1;var o=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return o??-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var n=this,o=this.getId(e);this.idNodeMap.delete(o),e.childNodes&&e.childNodes.forEach(function(r){return n.removeNodeFromMap(r)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,n){var o=n.id;this.idNodeMap.set(o,e),this.nodeMetaMap.set(e,n)},t.prototype.replace=function(e,n){var o=this.getNode(e);if(o){var r=this.nodeMetaMap.get(o);r&&this.nodeMetaMap.set(n,r)}this.idNodeMap.set(e,n)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},t}();function jt(t){const e=[];for(const n in t){const o=t[n];if(typeof o!="string")continue;const r=tr(n);e.push(`${r}: ${o};`)}return e.join(" ")}const jo=/-([a-z])/g,qo=/^--[a-zA-Z0-9-]+$/,yt=t=>qo.test(t)?t:t.replace(jo,(e,n)=>n?n.toUpperCase():""),er=/\B([A-Z])/g,tr=t=>t.replace(er,"-$1").toLowerCase();class pe{constructor(...e){this.childNodes=[],this.parentElement=null,this.parentNode=null,this.ELEMENT_NODE=ee.ELEMENT_NODE,this.TEXT_NODE=ee.TEXT_NODE}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get nextSibling(){const e=this.parentNode;if(!e)return null;const n=e.childNodes,o=n.indexOf(this);return n[o+1]||null}contains(e){if(e===this)return!0;for(const n of this.childNodes)if(n.contains(e))return!0;return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function Vn(t){return class extends t{constructor(e,n,o){super(),this.nodeType=ee.DOCUMENT_TYPE_NODE,this.RRNodeType=U.DocumentType,this.textContent=null,this.name=e,this.publicId=n,this.systemId=o,this.nodeName=e}toString(){return"RRDocumentType"}}}function Ln(t){return class extends t{constructor(e){super(),this.nodeType=ee.ELEMENT_NODE,this.RRNodeType=U.Element,this.attributes={},this.shadowRoot=null,this.tagName=e.toUpperCase(),this.nodeName=e.toUpperCase()}get textContent(){let e="";return this.childNodes.forEach(n=>e+=n.textContent),e}set textContent(e){this.childNodes=[this.ownerDocument.createTextNode(e)]}get classList(){return new nr(this.attributes.class,e=>{this.attributes.class=e})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const e=this.attributes.style?function(o){const r={},i=/:(.+)/;return o.replace(/\/\*.*?\*\//g,"").split(/;(?![^(]*\))/g).forEach(function(s){if(s){const a=s.split(i);a.length>1&&(r[yt(a[0].trim())]=a[1].trim())}}),r}(this.attributes.style):{},n=/\B([A-Z])/g;return e.setProperty=(o,r,i)=>{if(n.test(o))return;const s=yt(o);r?e[s]=r:delete e[s],i==="important"&&(e[s]+=" !important"),this.attributes.style=jt(e)},e.removeProperty=o=>{if(n.test(o))return"";const r=yt(o),i=e[r]||"";return delete e[r],this.attributes.style=jt(e),i},e}getAttribute(e){return this.attributes[e]||null}setAttribute(e,n){this.attributes[e]=n}setAttributeNS(e,n,o){this.setAttribute(n,o)}removeAttribute(e){delete this.attributes[e]}appendChild(e){return this.childNodes.push(e),e.parentNode=this,e.parentElement=this,e}insertBefore(e,n){if(n===null)return this.appendChild(e);const o=this.childNodes.indexOf(n);if(o==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(o,0,e),e.parentElement=this,e.parentNode=this,e}removeChild(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Failed to execute 'removeChild' on 'RRElement': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(n,1),e.parentElement=null,e.parentNode=null,e}attachShadow(e){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(e){return!0}toString(){let e="";for(const n in this.attributes)e+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${e}`}}}function $n(t){return class extends t{constructor(e){super(),this.nodeType=ee.TEXT_NODE,this.nodeName="#text",this.RRNodeType=U.Text,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function Un(t){return class extends t{constructor(e){super(),this.nodeType=ee.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=U.Comment,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function Wn(t){return class extends t{constructor(e){super(),this.nodeName="#cdata-section",this.nodeType=ee.CDATA_SECTION_NODE,this.RRNodeType=U.CDATA,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class nr{constructor(e,n){if(this.classes=[],this.add=(...o)=>{for(const r of o){const i=String(r);this.classes.indexOf(i)>=0||this.classes.push(i)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...o)=>{this.classes=this.classes.filter(r=>o.indexOf(r)===-1),this.onChange&&this.onChange(this.classes.join(" "))},e){const o=e.trim().split(/\s+/);this.classes.push(...o)}this.onChange=n}}var ee;(function(t){t[t.PLACEHOLDER=0]="PLACEHOLDER",t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",t[t.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",t[t.ENTITY_NODE=6]="ENTITY_NODE",t[t.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE",t[t.DOCUMENT_NODE=9]="DOCUMENT_NODE",t[t.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",t[t.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(ee||(ee={}));const Dt={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},or={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function fe(t,e,n,o){const r=t.childNodes,i=e.childNodes;o=o||e.mirror||e.ownerDocument.mirror,(r.length>0||i.length>0)&&qt(Array.from(r),i,t,n,o);let s=null,a=null;switch(e.RRNodeType){case U.Document:a=e.scrollData;break;case U.Element:{const l=t,u=e;switch(function(c,d,h){const f=c.attributes,p=d.attributes;for(const g in p){const C=p[g],m=h.getMeta(d);if(m&&"isSVG"in m&&m.isSVG&&Dt[g])c.setAttributeNS(Dt[g],g,C);else if(d.tagName==="CANVAS"&&g==="rr_dataURL"){const v=document.createElement("img");v.src=C,v.onload=()=>{const E=c.getContext("2d");E&&E.drawImage(v,0,0,v.width,v.height)}}else c.setAttribute(g,C)}for(const{name:g}of Array.from(f))g in p||c.removeAttribute(g);d.scrollLeft&&(c.scrollLeft=d.scrollLeft),d.scrollTop&&(c.scrollTop=d.scrollTop)}(l,u,o),a=u.scrollData,s=u.inputData,u.tagName){case"AUDIO":case"VIDEO":{const c=t,d=u;d.paused!==void 0&&(d.paused?c.pause():c.play()),d.muted!==void 0&&(c.muted=d.muted),d.volume!==void 0&&(c.volume=d.volume),d.currentTime!==void 0&&(c.currentTime=d.currentTime),d.playbackRate!==void 0&&(c.playbackRate=d.playbackRate);break}case"CANVAS":{const c=e;if(c.rr_dataURL!==null){const d=document.createElement("img");d.onload=()=>{const h=l.getContext("2d");h&&h.drawImage(d,0,0,d.width,d.height)},d.src=c.rr_dataURL}c.canvasMutations.forEach(d=>n.applyCanvas(d.event,d.mutation,t))}break;case"STYLE":{const c=l.sheet;c&&e.rules.forEach(d=>n.applyStyleSheetMutation(d,c))}}if(u.shadowRoot){l.shadowRoot||l.attachShadow({mode:"open"});const c=l.shadowRoot.childNodes,d=u.shadowRoot.childNodes;(c.length>0||d.length>0)&&qt(Array.from(c),d,l.shadowRoot,n,o)}break}case U.Text:case U.Comment:case U.CDATA:t.textContent!==e.data&&(t.textContent=e.data)}if(a&&n.applyScroll(a,!0),s&&n.applyInput(s),e.nodeName==="IFRAME"){const l=t.contentDocument,u=e;if(l){const c=o.getMeta(u.contentDocument);c&&n.mirror.add(l,Object.assign({},c)),fe(l,u.contentDocument,n,o)}}}function qt(t,e,n,o,r){var i;let s,a,l=0,u=t.length-1,c=0,d=e.length-1,h=t[l],f=t[u],p=e[c],g=e[d];for(;l<=u&&c<=d;){const C=o.mirror.getId(h),m=o.mirror.getId(f),v=r.getId(p),E=r.getId(g);if(h===void 0)h=t[++l];else if(f===void 0)f=t[--u];else if(C!==-1&&C===v)fe(h,p,o,r),h=t[++l],p=e[++c];else if(m!==-1&&m===E)fe(f,g,o,r),f=t[--u],g=e[--d];else if(C!==-1&&C===E)n.insertBefore(h,f.nextSibling),fe(h,g,o,r),h=t[++l],g=e[--d];else if(m!==-1&&m===v)n.insertBefore(f,h),fe(f,p,o,r),f=t[--u],p=e[++c];else{if(!s){s={};for(let A=l;A<=u;A++){const T=t[A];T&&o.mirror.hasNode(T)&&(s[o.mirror.getId(T)]=A)}}if(a=s[r.getId(p)],a){const A=t[a];n.insertBefore(A,h),fe(A,p,o,r),t[a]=void 0}else{const A=_t(p,o.mirror,r);n.nodeName==="#document"&&((i=o.mirror.getMeta(A))===null||i===void 0?void 0:i.type)===U.Element&&n.documentElement&&(n.removeChild(n.documentElement),t[l]=void 0,h=void 0),n.insertBefore(A,h||null),fe(A,p,o,r)}p=e[++c]}}if(l>u){const C=e[d+1];let m=null;for(C&&n.childNodes.forEach(v=>{o.mirror.getId(v)===r.getId(C)&&(m=v)});c<=d;++c){const v=_t(e[c],o.mirror,r);n.insertBefore(v,m),fe(v,e[c],o,r)}}else if(c>d)for(;l<=u;l++){const C=t[l];C&&(n.removeChild(C),o.mirror.removeNodeFromMap(C))}}function _t(t,e,n){const o=n.getId(t),r=n.getMeta(t);let i=null;if(o>-1&&(i=e.getNode(o)),i!==null)return i;switch(t.RRNodeType){case U.Document:i=new Document;break;case U.DocumentType:i=document.implementation.createDocumentType(t.name,t.publicId,t.systemId);break;case U.Element:{let s=t.tagName.toLowerCase();s=or[s]||s,i=r&&"isSVG"in r&&(r!=null&&r.isSVG)?document.createElementNS(Dt.svg,s):document.createElement(t.tagName);break}case U.Text:i=document.createTextNode(t.data);break;case U.Comment:i=document.createComment(t.data);break;case U.CDATA:i=document.createCDATASection(t.data)}return r&&e.add(i,Object.assign({},r)),i}class Ge extends function(e){return class Gn extends e{constructor(){super(...arguments),this.nodeType=ee.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=U.Document,this.textContent=null}get documentElement(){return this.childNodes.find(o=>o.RRNodeType===U.Element&&o.tagName==="HTML")||null}get body(){var o;return((o=this.documentElement)===null||o===void 0?void 0:o.childNodes.find(r=>r.RRNodeType===U.Element&&r.tagName==="BODY"))||null}get head(){var o;return((o=this.documentElement)===null||o===void 0?void 0:o.childNodes.find(r=>r.RRNodeType===U.Element&&r.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(o){const r=o.RRNodeType;if((r===U.Element||r===U.DocumentType)&&this.childNodes.some(i=>i.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${r===U.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);return o.parentElement=null,o.parentNode=this,this.childNodes.push(o),o}insertBefore(o,r){const i=o.RRNodeType;if((i===U.Element||i===U.DocumentType)&&this.childNodes.some(a=>a.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===U.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);if(r===null)return this.appendChild(o);const s=this.childNodes.indexOf(r);if(s==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(s,0,o),o.parentElement=null,o.parentNode=this,o}removeChild(o){const r=this.childNodes.indexOf(o);if(r===-1)throw new Error("Failed to execute 'removeChild' on 'RRDocument': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(r,1),o.parentElement=null,o.parentNode=null,o}open(){this.childNodes=[]}close(){}write(o){let r;if(o==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?r="-//W3C//DTD XHTML 1.0 Transitional//EN":o==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(r="-//W3C//DTD HTML 4.0 Transitional//EN"),r){const i=this.createDocumentType("html",r,"");this.open(),this.appendChild(i)}}createDocument(o,r,i){return new Gn}createDocumentType(o,r,i){const s=new(Vn(pe))(o,r,i);return s.ownerDocument=this,s}createElement(o){const r=new(Ln(pe))(o);return r.ownerDocument=this,r}createElementNS(o,r){return this.createElement(r)}createTextNode(o){const r=new($n(pe))(o);return r.ownerDocument=this,r}createComment(o){const r=new(Un(pe))(o);return r.ownerDocument=this,r}createCDATASection(o){const r=new(Wn(pe))(o);return r.ownerDocument=this,r}toString(){return"RRDocument"}}}(pe){constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=new pr,this.scrollData=null,e&&(this.mirror=e)}get unserializedId(){return this._unserializedId--}createDocument(e,n,o){return new Ge}createDocumentType(e,n,o){const r=new rr(e,n,o);return r.ownerDocument=this,r}createElement(e){const n=e.toUpperCase();let o;switch(n){case"AUDIO":case"VIDEO":o=new sr(n);break;case"IFRAME":o=new lr(n,this.mirror);break;case"CANVAS":o=new ir(n);break;case"STYLE":o=new ar(n);break;default:o=new qe(n)}return o.ownerDocument=this,o}createComment(e){const n=new ur(e);return n.ownerDocument=this,n}createCDATASection(e){const n=new dr(e);return n.ownerDocument=this,n}createTextNode(e){const n=new cr(e);return n.ownerDocument=this,n}destroyTree(){this.childNodes=[],this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const rr=Vn(pe);class qe extends Ln(pe){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class sr extends function(e){return class extends e{attachShadow(n){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}(qe){}class ir extends qe{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class ar extends qe{constructor(){super(...arguments),this.rules=[]}}class lr extends qe{constructor(e,n){super(e),this.contentDocument=new Ge,this.contentDocument.mirror=n}}const cr=$n(pe),ur=Un(pe),dr=Wn(pe);function Zn(t,e,n,o){let r;switch(t.nodeType){case ee.DOCUMENT_NODE:o&&o.nodeName==="IFRAME"?r=o.contentDocument:(r=e,r.compatMode=t.compatMode);break;case ee.DOCUMENT_TYPE_NODE:{const s=t;r=e.createDocumentType(s.name,s.publicId,s.systemId);break}case ee.ELEMENT_NODE:{const s=t,a=function(u){return u instanceof HTMLFormElement?"FORM":u.tagName.toUpperCase()}(s);r=e.createElement(a);const l=r;for(const{name:u,value:c}of Array.from(s.attributes))l.attributes[u]=c;s.scrollLeft&&(l.scrollLeft=s.scrollLeft),s.scrollTop&&(l.scrollTop=s.scrollTop);break}case ee.TEXT_NODE:r=e.createTextNode(t.textContent||"");break;case ee.CDATA_SECTION_NODE:r=e.createCDATASection(t.data);break;case ee.COMMENT_NODE:r=e.createComment(t.textContent||"");break;case ee.DOCUMENT_FRAGMENT_NODE:r=o.attachShadow({mode:"open"});break;default:return null}let i=n.getMeta(t);return e instanceof Ge&&(i||(i=Pn(r,e.unserializedId),n.add(t,i)),e.mirror.add(r,Object.assign({},i))),r}function hr(t,e=function(){return new Xo}(),n=new Ge){return function o(r,i){const s=Zn(r,n,e,i);if(s!==null)if((i==null?void 0:i.nodeName)!=="IFRAME"&&r.nodeType!==ee.DOCUMENT_FRAGMENT_NODE&&(i==null||i.appendChild(s),s.parentNode=i,s.parentElement=i),r.nodeName==="IFRAME"){const a=r.contentDocument;a&&o(a,s)}else r.nodeType!==ee.DOCUMENT_NODE&&r.nodeType!==ee.ELEMENT_NODE&&r.nodeType!==ee.DOCUMENT_FRAGMENT_NODE||(r.nodeType===ee.ELEMENT_NODE&&r.shadowRoot&&o(r.shadowRoot,s),r.childNodes.forEach(a=>o(a,s)))}(t,null),n}class pr{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const o=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return o??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(o=>this.removeNodeFromMap(o))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const o=n.id;this.idNodeMap.set(o,e),this.nodeMetaMap.set(e,n)}replace(e,n){const o=this.getNode(e);if(o){const r=this.nodeMetaMap.get(o);r&&this.nodeMetaMap.set(n,r)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Pn(t,e){switch(t.RRNodeType){case U.Document:return{id:e,type:t.RRNodeType,childNodes:[]};case U.DocumentType:{const n=t;return{id:e,type:t.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case U.Element:return{id:e,type:t.RRNodeType,tagName:t.tagName.toLowerCase(),attributes:{},childNodes:[]};case U.Text:case U.Comment:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case U.CDATA:return{id:e,type:t.RRNodeType,textContent:""}}}var ue=Uint8Array,Me=Uint16Array,Mt=Uint32Array,Kn=new ue([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Yn=new ue([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gr=new ue([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),zn=function(t,e){for(var n=new Me(31),o=0;o<31;++o)n[o]=e+=1<<t[o-1];var r=new Mt(n[30]);for(o=1;o<30;++o)for(var i=n[o];i<n[o+1];++i)r[i]=i-n[o]<<5|o;return[n,r]},Qn=zn(Kn,2),Jn=Qn[0],mr=Qn[1];Jn[28]=258,mr[258]=28;for(var fr=zn(Yn,0)[0],Hn=new Me(32768),X=0;X<32768;++X){var Ne=(43690&X)>>>1|(21845&X)<<1;Ne=(61680&(Ne=(52428&Ne)>>>2|(13107&Ne)<<2))>>>4|(3855&Ne)<<4,Hn[X]=((65280&Ne)>>>8|(255&Ne)<<8)>>>1}var He=function(t,e,n){for(var o=t.length,r=0,i=new Me(e);r<o;++r)++i[t[r]-1];var s,a=new Me(e);for(r=0;r<e;++r)a[r]=a[r-1]+i[r-1]<<1;{s=new Me(1<<e);var l=15-e;for(r=0;r<o;++r)if(t[r])for(var u=r<<4|t[r],c=e-t[r],d=a[t[r]-1]++<<c,h=d|(1<<c)-1;d<=h;++d)s[Hn[d]>>>l]=u}return s},et=new ue(288);for(X=0;X<144;++X)et[X]=8;for(X=144;X<256;++X)et[X]=9;for(X=256;X<280;++X)et[X]=7;for(X=280;X<288;++X)et[X]=8;var Xn=new ue(32);for(X=0;X<32;++X)Xn[X]=5;var vr=He(et,9),yr=He(Xn,5),Ct=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},he=function(t,e,n){var o=e/8>>0;return(t[o]|t[o+1]<<8)>>>(7&e)&n},It=function(t,e){var n=e/8>>0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>>(7&e)},jn=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var o=new(t instanceof Me?Me:t instanceof Mt?Mt:ue)(n-e);return o.set(t.subarray(e,n)),o};function Cr(t,e){return function(n,o,r){var i=n.length,s=!o||r,a=!r||r.i;r||(r={}),o||(o=new ue(3*i));var l,u=function(de){var Vt=o.length;if(de>Vt){var Lt=new ue(Math.max(2*Vt,de));Lt.set(o),o=Lt}},c=r.f||0,d=r.p||0,h=r.b||0,f=r.l,p=r.d,g=r.m,C=r.n,m=8*i;do{if(!f){r.f=c=he(n,d,1);var v=he(n,d+1,3);if(d+=3,!v){var E=n[(_=((l=d)/8>>0)+(7&l&&1)+4)-4]|n[_-3]<<8,A=_+E;if(A>i){if(a)throw"unexpected EOF";break}s&&u(h+E),o.set(n.subarray(_,A),h),r.b=h+=E,r.p=d=8*A;continue}if(v==1)f=vr,p=yr,g=9,C=5;else{if(v!=2)throw"invalid block type";var T=he(n,d,31)+257,O=he(n,d+10,15)+4,F=T+he(n,d+5,31)+1;d+=14;for(var N=new ue(F),b=new ue(19),x=0;x<O;++x)b[gr[x]]=he(n,d+3*x,7);d+=3*O;var w=Ct(b),y=(1<<w)-1;if(!a&&d+F*(w+7)>m)break;var R=He(b,w);for(x=0;x<F;){var _,Q=R[he(n,d,y)];if(d+=15&Q,(_=Q>>>4)<16)N[x++]=_;else{var G=0,I=0;for(_==16?(I=3+he(n,d,3),d+=2,G=N[x-1]):_==17?(I=3+he(n,d,7),d+=3):_==18&&(I=11+he(n,d,127),d+=7);I--;)N[x++]=G}}var L=N.subarray(0,T),$=N.subarray(T);g=Ct(L),C=Ct($),f=He(L,g),p=He($,C)}if(d>m)throw"unexpected EOF"}s&&u(h+131072);for(var q=(1<<g)-1,te=(1<<C)-1,ge=g+C+18;a||d+ge<m;){var oe=(G=f[It(n,d)&q])>>>4;if((d+=15&G)>m)throw"unexpected EOF";if(!G)throw"invalid length/literal";if(oe<256)o[h++]=oe;else{if(oe==256){f=null;break}var S=oe-254;if(oe>264){var K=Kn[x=oe-257];S=he(n,d,(1<<K)-1)+Jn[x],d+=K}var z=p[It(n,d)&te],me=z>>>4;if(!z)throw"invalid distance";if(d+=15&z,$=fr[me],me>3&&(K=Yn[me],$+=It(n,d)&(1<<K)-1,d+=K),d>m)throw"unexpected EOF";s&&u(h+131072);for(var B=h+S;h<B;h+=4)o[h]=o[h-$],o[h+1]=o[h+1-$],o[h+2]=o[h+2-$],o[h+3]=o[h+3-$];h=B}}r.l=f,r.p=d,r.b=h,f&&(c=1,r.m=g,r.d=p,r.n=C)}while(!c);return h==o.length?o:jn(o,0,h)}((function(n){if((15&n[0])!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(32&n[1])throw"invalid zlib data: preset dictionaries not supported"}(t),t.subarray(2,-4)),e)}const Ir=t=>{if(typeof t!="string")return t;try{const e=JSON.parse(t);if(e.timestamp)return e}catch{}try{const e=JSON.parse(function(n,o){var r="";if(!o&&typeof TextDecoder<"u")return new TextDecoder().decode(n);for(var i=0;i<n.length;){var s=n[i++];s<128||o?r+=String.fromCharCode(s):s<224?r+=String.fromCharCode((31&s)<<6|63&n[i++]):s<240?r+=String.fromCharCode((15&s)<<12|(63&n[i++])<<6|63&n[i++]):(s=((15&s)<<18|(63&n[i++])<<12|(63&n[i++])<<6|63&n[i++])-65536,r+=String.fromCharCode(55296|s>>10,56320|1023&s))}return r}(Cr(function(n,o){for(var r=n.length,i=new ue(n.length+(n.length>>>1)),s=0,a=function(d){i[s++]=d},l=0;l<r;++l){if(s+5>i.length){var u=new ue(s+8+(r-l<<1));u.set(i),i=u}var c=n.charCodeAt(l);c<128||o?a(c):c<2048?(a(192|c>>>6),a(128|63&c)):c>55295&&c<57344?(a(240|(c=65536+(1047552&c)|1023&n.charCodeAt(++l))>>>18),a(128|c>>>12&63),a(128|c>>>6&63),a(128|63&c)):(a(224|c>>>12),a(128|c>>>6&63),a(128|63&c))}return jn(i,0,s)}(t,!0))));if(e.v==="v1")return e;throw new Error(`These events were packed with packer ${e.v} which is incompatible with current packer v1.`)}catch(e){throw console.error(e),new Error("Unknown data format.")}};function qn(t){return{all:t=t||new Map,on:function(e,n){var o=t.get(e);o?o.push(n):t.set(e,[n])},off:function(e,n){var o=t.get(e);o&&(n?o.splice(o.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var o=t.get(e);o&&o.slice().map(function(r){r(n)}),(o=t.get("*"))&&o.slice().map(function(r){r(e,n)})}}}var Be,br=Object.freeze({__proto__:null,default:qn});function Ar(t=window,e=document){if("scrollBehavior"in e.documentElement.style&&t.__forceSmoothScrollPolyfill__!==!0)return;const n=t.HTMLElement||t.Element,o={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:n.prototype.scroll||a,scrollIntoView:n.prototype.scrollIntoView},r=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now,i=(s=t.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(s)?1:0);var s;function a(g,C){this.scrollLeft=g,this.scrollTop=C}function l(g){if(g===null||typeof g!="object"||g.behavior===void 0||g.behavior==="auto"||g.behavior==="instant")return!0;if(typeof g=="object"&&g.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+g.behavior+" is not a valid value for enumeration ScrollBehavior.")}function u(g,C){return C==="Y"?g.clientHeight+i<g.scrollHeight:C==="X"?g.clientWidth+i<g.scrollWidth:void 0}function c(g,C){const m=t.getComputedStyle(g,null)["overflow"+C];return m==="auto"||m==="scroll"}function d(g){const C=u(g,"Y")&&c(g,"Y"),m=u(g,"X")&&c(g,"X");return C||m}function h(g){for(;g!==e.body&&d(g)===!1;)g=g.parentNode||g.host;return g}function f(g){let C,m,v,E=(r()-g.startTime)/468;var A;E=E>1?1:E,A=E,C=.5*(1-Math.cos(Math.PI*A)),m=g.startX+(g.x-g.startX)*C,v=g.startY+(g.y-g.startY)*C,g.method.call(g.scrollable,m,v),m===g.x&&v===g.y||t.requestAnimationFrame(f.bind(t,g))}function p(g,C,m){let v,E,A,T;const O=r();g===e.body?(v=t,E=t.scrollX||t.pageXOffset,A=t.scrollY||t.pageYOffset,T=o.scroll):(v=g,E=g.scrollLeft,A=g.scrollTop,T=a),f({scrollable:v,method:T,startTime:O,startX:E,startY:A,x:C,y:m})}t.scroll=t.scrollTo=function(){arguments[0]!==void 0&&(l(arguments[0])!==!0?p.call(t,e.body,arguments[0].left!==void 0?~~arguments[0].left:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:t.scrollY||t.pageYOffset):o.scroll.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:t.scrollY||t.pageYOffset))},t.scrollBy=function(){arguments[0]!==void 0&&(l(arguments[0])?o.scrollBy.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0):p.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset)))},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(l(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");return void o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop)}const g=arguments[0].left,C=arguments[0].top;p.call(this,this,g===void 0?this.scrollLeft:~~g,C===void 0?this.scrollTop:~~C)},n.prototype.scrollBy=function(){arguments[0]!==void 0&&(l(arguments[0])!==!0?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},n.prototype.scrollIntoView=function(){if(l(arguments[0])===!0)return void o.scrollIntoView.call(this,arguments[0]===void 0||arguments[0]);const g=h(this),C=g.getBoundingClientRect(),m=this.getBoundingClientRect();g!==e.body?(p.call(this,g,g.scrollLeft+m.left-C.left,g.scrollTop+m.top-C.top),t.getComputedStyle(g).position!=="fixed"&&t.scrollBy({left:C.left,top:C.top,behavior:"smooth"})):t.scrollBy({left:m.left,top:m.top,behavior:"smooth"})}}class wr{constructor(e=[],n){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=n.speed,this.liveMode=n.liveMode}addAction(e){if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay)return void this.actions.push(e);const n=this.findActionIndex(e);this.actions.splice(n,0,e)}start(){this.timeOffset=0;let e=performance.now();const n=()=>{const o=performance.now();for(this.timeOffset+=(o-e)*this.speed,e=o;this.actions.length;){const r=this.actions[0];if(!(this.timeOffset>=r.delay))break;this.actions.shift(),r.doAction()}(this.actions.length>0||this.liveMode)&&(this.raf=requestAnimationFrame(n))};this.raf=requestAnimationFrame(n)}clear(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}toggleLiveMode(e){this.liveMode=e}isActive(){return this.raf!==null}findActionIndex(e){let n=0,o=this.actions.length-1;for(;n<=o;){const r=Math.floor((n+o)/2);if(this.actions[r].delay<e.delay)n=r+1;else{if(!(this.actions[r].delay>e.delay))return r+1;o=r-1}}return n}}function en(t,e){if(t.type===J.IncrementalSnapshot&&t.data.source===Z.MouseMove&&t.data.positions&&t.data.positions.length){const n=t.data.positions[0].timeOffset,o=t.timestamp+n;return t.delay=o-e,o-e}return t.delay=t.timestamp-e,t.delay}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function tn(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(Be||(Be={}));var eo={type:"xstate.init"};function bt(t){return t===void 0?[]:[].concat(t)}function Fe(t){return{type:"xstate.assign",assignment:t}}function nn(t,e){return typeof(t=typeof t=="string"&&e&&e[t]?e[t]:t)=="string"?{type:t}:typeof t=="function"?{type:t.name,exec:t}:t}function dt(t){return function(e){return t===e}}function to(t){return typeof t=="string"?{type:t}:t}function on(t,e){return{value:t,context:e,actions:[],changed:!1,matches:dt(t)}}function rn(t,e,n){var o=e,r=!1;return[t.filter(function(i){if(i.type==="xstate.assign"){r=!0;var s=Object.assign({},o);return typeof i.assignment=="function"?s=i.assignment(o,n):Object.keys(i.assignment).forEach(function(a){s[a]=typeof i.assignment[a]=="function"?i.assignment[a](o,n):i.assignment[a]}),o=s,!1}return!0}),o,r]}function no(t,e){e===void 0&&(e={});var n=tn(rn(bt(t.states[t.initial].entry).map(function(s){return nn(s,e.actions)}),t.context,eo),2),o=n[0],r=n[1],i={config:t,_options:e,initialState:{value:t.initial,actions:o,context:r,matches:dt(t.initial)},transition:function(s,a){var l,u,c=typeof s=="string"?{value:s,context:t.context}:s,d=c.value,h=c.context,f=to(a),p=t.states[d];if(p.on){var g=bt(p.on[f.type]);try{for(var C=function(I){var L=typeof Symbol=="function"&&Symbol.iterator,$=L&&I[L],q=0;if($)return $.call(I);if(I&&typeof I.length=="number")return{next:function(){return I&&q>=I.length&&(I=void 0),{value:I&&I[q++],done:!I}}};throw new TypeError(L?"Object is not iterable.":"Symbol.iterator is not defined.")}(g),m=C.next();!m.done;m=C.next()){var v=m.value;if(v===void 0)return on(d,h);var E=typeof v=="string"?{target:v}:v,A=E.target,T=E.actions,O=T===void 0?[]:T,F=E.cond,N=F===void 0?function(){return!0}:F,b=A===void 0,x=A??d,w=t.states[x];if(N(h,f)){var y=tn(rn((b?bt(O):[].concat(p.exit,O,w.entry).filter(function(I){return I})).map(function(I){return nn(I,i._options.actions)}),h,f),3),R=y[0],_=y[1],Q=y[2],G=A??d;return{value:G,context:_,actions:R,changed:A!==d||R.length>0||Q,matches:dt(G)}}}}catch(I){l={error:I}}finally{try{m&&!m.done&&(u=C.return)&&u.call(C)}finally{if(l)throw l.error}}}return on(d,h)}};return i}var sn=function(t,e){return t.actions.forEach(function(n){var o=n.exec;return o&&o(t.context,e)})};function oo(t){var e=t.initialState,n=Be.NotStarted,o=new Set,r={_machine:t,send:function(i){n===Be.Running&&(e=t.transition(e,i),sn(e,to(i)),o.forEach(function(s){return s(e)}))},subscribe:function(i){return o.add(i),i(e),{unsubscribe:function(){return o.delete(i)}}},start:function(i){if(i){var s=typeof i=="object"?i:{context:t.config.context,value:i};e={value:s.value,actions:[],context:s.context,matches:dt(s.value)}}return n=Be.Running,sn(e,eo),r},stop:function(){return n=Be.Stopped,o.clear(),r},get state(){return e},get status(){return n}};return r}function Sr(t,{getCastFn:e,applyEventsSynchronously:n,emitter:o}){const r=no({id:"player",context:t,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Fe({lastPlayedEvent:(i,s)=>s.type==="CAST_EVENT"?s.payload.event:i.lastPlayedEvent}),recordTimeOffset:Fe((i,s)=>{let a=i.timeOffset;return"payload"in s&&"timeOffset"in s.payload&&(a=s.payload.timeOffset),Object.assign(Object.assign({},i),{timeOffset:a,baselineTime:i.events[0].timestamp+a})}),play(i){var s;const{timer:a,events:l,baselineTime:u,lastPlayedEvent:c}=i;a.clear();for(const p of l)en(p,u);const d=function(p,g){for(let C=p.length-1;C>=0;C--){const m=p[C];if(m.type===J.Meta&&m.timestamp<=g)return p.slice(C)}return p}(l,u);let h=c==null?void 0:c.timestamp;(c==null?void 0:c.type)===J.IncrementalSnapshot&&c.data.source===Z.MouseMove&&(h=c.timestamp+((s=c.data.positions[0])===null||s===void 0?void 0:s.timeOffset)),u<(h||0)&&o.emit(Y.PlayBack);const f=new Array;for(const p of d)if(!(h&&h<u&&(p.timestamp<=h||p===c)))if(p.timestamp<u)f.push(p);else{const g=e(p,!1);a.addAction({doAction:()=>{g()},delay:p.delay})}n(f),o.emit(Y.Flush),a.start()},pause(i){i.timer.clear()},resetLastPlayedEvent:Fe(i=>Object.assign(Object.assign({},i),{lastPlayedEvent:null})),startLive:Fe({baselineTime:(i,s)=>(i.timer.toggleLiveMode(!0),i.timer.start(),s.type==="TO_LIVE"&&s.payload.baselineTime?s.payload.baselineTime:Date.now())}),addEvent:Fe((i,s)=>{const{baselineTime:a,timer:l,events:u}=i;if(s.type==="ADD_EVENT"){const{event:c}=s.payload;en(c,a);let d=u.length-1;if(!u[d]||u[d].timestamp<=c.timestamp)u.push(c);else{let p=-1,g=0;for(;g<=d;){const C=Math.floor((g+d)/2);u[C].timestamp<=c.timestamp?g=C+1:d=C-1}p===-1&&(p=g),u.splice(p,0,c)}const h=c.timestamp<a,f=e(c,h);h?f():l.isActive()&&l.addAction({doAction:()=>{f()},delay:c.delay})}return Object.assign(Object.assign({},i),{events:u})})}});return oo(r)}const an=new Map;function ro(t,e){let n=an.get(t);return n||(n=new Map,an.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}function Se(t,e,n){return o=>_e(this,void 0,void 0,function*(){if(o&&typeof o=="object"&&"rr_type"in o){if(n&&(n.isUnchanged=!1),o.rr_type==="ImageBitmap"&&"args"in o){const r=yield Se(t,e,n)(o.args);return yield createImageBitmap.apply(null,r)}if("index"in o){if(n||e===null)return o;const{rr_type:r,index:i}=o;return ro(e,r)[i]}if("args"in o){const{rr_type:r,args:i}=o;return new window[r](...yield Promise.all(i.map(Se(t,e,n))))}if("base64"in o)return function(r){var i,s,a,l,u,c=.75*r.length,d=r.length,h=0;r[r.length-1]==="="&&(c--,r[r.length-2]==="="&&c--);var f=new ArrayBuffer(c),p=new Uint8Array(f);for(i=0;i<d;i+=4)s=Ye[r.charCodeAt(i)],a=Ye[r.charCodeAt(i+1)],l=Ye[r.charCodeAt(i+2)],u=Ye[r.charCodeAt(i+3)],p[h++]=s<<2|a>>4,p[h++]=(15&a)<<4|l>>2,p[h++]=(3&l)<<6|63&u;return f}(o.base64);if("src"in o){const r=t.get(o.src);if(r)return r;{const i=new Image;return i.src=o.src,t.set(o.src,i),i}}if("data"in o&&o.rr_type==="Blob"){const r=yield Promise.all(o.data.map(Se(t,e,n)));return new Blob(r,{type:o.type})}}else if(Array.isArray(o))return yield Promise.all(o.map(Se(t,e,n)));return o})}const Er=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function Nr({mutation:t,target:e,type:n,imageMap:o,errorHandler:r}){return _e(this,void 0,void 0,function*(){try{const i=function(l,u){try{return u===ut.WebGL?l.getContext("webgl")||l.getContext("experimental-webgl"):l.getContext("webgl2")}catch{return null}}(e,n);if(!i)return;if(t.setter)return void(i[t.property]=t.args[0]);const s=i[t.property],a=yield Promise.all(t.args.map(Se(o,i)));(function(l,u){if(!(u!=null&&u.constructor))return;const{name:c}=u.constructor;if(!Er.includes(c))return;const d=ro(l,c);d.includes(u)||d.push(u)})(i,s.apply(i,a))}catch(i){r(t,i)}})}function Tr({event:t,mutation:e,target:n,imageMap:o,errorHandler:r}){return _e(this,void 0,void 0,function*(){try{const i=n.getContext("2d");if(e.setter)return void(i[e.property]=e.args[0]);const s=i[e.property];if(e.property==="drawImage"&&typeof e.args[0]=="string")o.get(t),s.apply(i,e.args);else{const a=yield Promise.all(e.args.map(Se(o,i)));s.apply(i,a)}}catch(i){r(e,i)}})}function ln({event:t,mutation:e,target:n,imageMap:o,canvasEventMap:r,errorHandler:i}){return _e(this,void 0,void 0,function*(){try{const s=r.get(t)||e,a="commands"in s?s.commands:[s];if([ut.WebGL,ut.WebGL2].includes(e.type)){for(let l=0;l<a.length;l++){const u=a[l];yield Nr({mutation:u,type:e.type,target:n,imageMap:o,errorHandler:i})}return}for(let l=0;l<a.length;l++){const u=a[l];yield Tr({event:t,mutation:u,target:n,imageMap:o,errorHandler:i})}}catch(s){i(e,s)}})}const Dr=qn||br,At={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function cn(t){return t.type==J.IncrementalSnapshot&&(t.data.source==Z.TouchMove||t.data.source==Z.MouseInteraction&&t.data.type==le.TouchStart)}class _r{constructor(e,n){if(this.usingVirtualDom=!1,this.virtualDom=new Ge,this.mouseTail=null,this.tailPositions=[],this.emitter=Dr(),this.legacy_missingNodeRetryMap={},this.cache=Kt(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Wo(),this.styleMirror=new zo,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=a=>{this.iframe.style.display="inherit";for(const l of[this.mouseTail,this.iframe])l&&(l.setAttribute("width",String(a.width)),l.setAttribute("height",String(a.height)))},this.applyEventsSynchronously=a=>{for(const l of a){switch(l.type){case J.DomContentLoaded:case J.Load:case J.Custom:continue;case J.FullSnapshot:case J.Meta:case J.Plugin:case J.IncrementalSnapshot:}this.getCastFn(l,!0)()}this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null},this.getCastFn=(a,l=!1)=>{let u;switch(a.type){case J.DomContentLoaded:case J.Load:break;case J.Custom:u=()=>{this.emitter.emit(Y.CustomEvent,a)};break;case J.Meta:u=()=>this.emitter.emit(Y.Resize,{width:a.data.width,height:a.data.height});break;case J.FullSnapshot:u=()=>{var c;if(this.firstFullSnapshot){if(this.firstFullSnapshot===a)return void(this.firstFullSnapshot=!0)}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(a,l),(c=this.iframe.contentWindow)===null||c===void 0||c.scrollTo(a.data.initialOffset),this.styleMirror.reset()};break;case J.IncrementalSnapshot:u=()=>{if(this.applyIncremental(a,l),!l&&(a===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const c of this.service.state.context.events)if(!(c.timestamp<=a.timestamp)&&this.isUserInteraction(c)){c.delay-a.delay>1e4*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=c);break}if(this.nextUserInteractionEvent){const c=this.nextUserInteractionEvent.delay-a.delay,d={speed:Math.min(Math.round(c/5e3),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:d}),this.emitter.emit(Y.SkipStart,d)}}}}return()=>{u&&u();for(const d of this.config.plugins||[])d.handler&&d.handler(a,l,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:a}});const c=this.service.state.context.events.length-1;if(a===this.service.state.context.events[c]){const d=()=>{c<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(Y.Finish))};a.type===J.IncrementalSnapshot&&a.data.source===Z.MouseMove&&a.data.positions.length?setTimeout(()=>{d()},Math.max(0,50-a.data.positions[0].timeOffset)):d()}this.emitter.emit(Y.EventCast,a)}},!(n!=null&&n.liveMode)&&e.length<2)throw new Error("Replayer need at least 2 events.");const o={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:At,useVirtualDom:!0};this.config=Object.assign({},o,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(Y.Resize,this.handleResize),this.setupDom();for(const a of this.config.plugins||[])a.getMirror&&a.getMirror({nodeMirror:this.mirror});this.emitter.on(Y.Flush,()=>{if(this.usingVirtualDom){const a={mirror:this.mirror,applyCanvas:(l,u,c)=>{ln({event:l,mutation:u,target:c,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(l,u)=>{l.source===Z.StyleSheetRule?this.applyStyleSheetRule(l,u):l.source===Z.StyleDeclaration&&this.applyStyleDeclaration(l,u)}};if(this.iframe.contentDocument&&fe(this.iframe.contentDocument,this.virtualDom,a,this.virtualDom.mirror),this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const l in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[l],c=_t(u.node,this.mirror,this.virtualDom.mirror);fe(c,u.node,a,this.virtualDom.mirror),u.node=c}catch(u){this.config.showWarning&&console.warn(u)}this.constructedStyleMutations.forEach(l=>{this.applyStyleSheetMutation(l)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(l=>{this.applyAdoptedStyleSheet(l)}),this.adoptedStyleSheets=[]}this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(Y.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});const r=new wr([],{speed:this.config.speed,liveMode:this.config.liveMode});this.service=Sr({events:e.map(a=>n&&n.unpackFn?n.unpackFn(a):a).sort((a,l)=>a.timestamp-l.timestamp),timer:r,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(a=>{this.emitter.emit(Y.StateChange,{player:a})}),this.speedService=oo(no({id:"speed",context:{normalSpeed:-1,timer:r},initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(a,l)=>{"payload"in l&&a.timer.setSpeed(l.payload.speed)},recordSpeed:Fe({normalSpeed:a=>a.timer.speed}),restoreSpeed:a=>{a.timer.setSpeed(a.normalSpeed)}}})),this.speedService.start(),this.speedService.subscribe(a=>{this.emitter.emit(Y.StateChange,{speed:a})});const i=this.service.state.context.events.find(a=>a.type===J.Meta),s=this.service.state.context.events.find(a=>a.type===J.FullSnapshot);if(i){const{width:a,height:l}=i.data;setTimeout(()=>{this.emitter.emit(Y.Resize,{width:a,height:l})},0)}s&&setTimeout(()=>{var a;this.firstFullSnapshot||(this.firstFullSnapshot=s,this.rebuildFullSnapshot(s),(a=this.iframe.contentWindow)===null||a===void 0||a.scrollTo(s.data.initialOffset))},1),this.service.state.context.events.find(cn)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(e,n){return this.emitter.on(e,n),this}off(e,n){return this.emitter.off(e,n),this}setConfig(e){Object.keys(e).forEach(n=>{e[n],this.config[n]=e[n]}),this.config.skipInactive||this.backToNormal(),e.speed!==void 0&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),e.mouseTail!==void 0&&(e.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const e=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:n.timestamp,totalTime:n.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:e,events:n}=this.service.state.context;return e-n[0].timestamp}getMirror(){return this.mirror}play(e=0){var n,o;this.service.state.matches("paused")||this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}}),(o=(n=this.iframe.contentDocument)===null||n===void 0?void 0:n.getElementsByTagName("html")[0])===null||o===void 0||o.classList.remove("rrweb-paused"),this.emitter.emit(Y.Start)}pause(e){var n,o;e===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof e=="number"&&(this.play(e),this.service.send({type:"PAUSE"})),(o=(n=this.iframe.contentDocument)===null||n===void 0?void 0:n.getElementsByTagName("html")[0])===null||o===void 0||o.classList.add("rrweb-paused"),this.emitter.emit(Y.Pause)}resume(e=0){console.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(Y.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(Y.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){const n=this.config.unpackFn?this.config.unpackFn(e):e;cn(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Kt()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Ar(this.iframe.contentWindow,this.iframe.contentDocument),function(n=window){"NodeList"in n&&!n.NodeList.prototype.forEach&&(n.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in n&&!n.DOMTokenList.prototype.forEach&&(n.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...o)=>{let r=o[0];if(!(0 in o))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}(this.iframe.contentWindow))}rebuildFullSnapshot(e,n=!1){if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const o=[],r=(a,l)=>{this.collectIframeAndAttachDocument(o,a);for(const u of this.config.plugins||[])u.onBuild&&u.onBuild(a,{id:l,replayer:this})};Ko(e.data.node,{doc:this.iframe.contentDocument,afterAppend:r,cache:this.cache,mirror:this.mirror}),r(this.iframe.contentDocument,e.data.node.id);for(const{mutationInQueue:a,builtNode:l}of o)this.attachDocumentToIframe(a,l),this.newDocumentQueue=this.newDocumentQueue.filter(u=>u!==a);const{documentElement:i,head:s}=this.iframe.contentDocument;this.insertStyleRules(i,s),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(Y.FullsnapshotRebuilded,e),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,n){var o;const r=(i=this.config.blockClass,[`.${i} { background: currentColor }`,"noscript { display: none !important; }"]).concat(this.config.insertStyleRules);var i;if(this.config.pauseAnimation&&r.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const s=this.virtualDom.createElement("style");this.virtualDom.mirror.add(s,Pn(s,this.virtualDom.unserializedId)),e.insertBefore(s,n),s.rules.push({source:Z.StyleSheetRule,adds:r.map((a,l)=>({rule:a,index:l}))})}else{const s=document.createElement("style");e.insertBefore(s,n);for(let a=0;a<r.length;a++)(o=s.sheet)===null||o===void 0||o.insertRule(r[a],a)}}attachDocumentToIframe(e,n){const o=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,r=[],i=(s,a)=>{this.collectIframeAndAttachDocument(r,s);const l=o.getMeta(s);if((l==null?void 0:l.type)===se.Element&&(l==null?void 0:l.tagName.toUpperCase())==="HTML"){const{documentElement:u,head:c}=n.contentDocument;this.insertStyleRules(u,c)}for(const u of this.config.plugins||[])u.onBuild&&u.onBuild(s,{id:a,replayer:this})};Je(e.node,{doc:n.contentDocument,mirror:o,hackCss:!0,skipChild:!1,afterAppend:i,cache:this.cache}),i(n.contentDocument,e.node.id);for(const{mutationInQueue:s,builtNode:a}of r)this.attachDocumentToIframe(s,a),this.newDocumentQueue=this.newDocumentQueue.filter(l=>l!==s)}collectIframeAndAttachDocument(e,n){if(vt(n,this.mirror)){const o=this.newDocumentQueue.find(r=>r.parentId===this.mirror.getId(n));o&&e.push({mutationInQueue:o,builtNode:n})}}waitForStylesheetLoad(){var e;const n=(e=this.iframe.contentDocument)===null||e===void 0?void 0:e.head;if(n){const o=new Set;let r,i=this.service.state;const s=()=>{i=this.service.state};this.emitter.on(Y.Start,s),this.emitter.on(Y.Pause,s);const a=()=>{this.emitter.off(Y.Start,s),this.emitter.off(Y.Pause,s)};n.querySelectorAll('link[rel="stylesheet"]').forEach(l=>{l.sheet||(o.add(l),l.addEventListener("load",()=>{o.delete(l),o.size===0&&r!==-1&&(i.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(Y.LoadStylesheetEnd),r&&clearTimeout(r),a())}))}),o.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(Y.LoadStylesheetStart),r=setTimeout(()=>{i.matches("playing")&&this.play(this.getCurrentTime()),r=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return _e(this,void 0,void 0,function*(){this.service.state;const e=()=>{this.service.state};this.emitter.on(Y.Start,e),this.emitter.on(Y.Pause,e);const n=[];for(const o of this.service.state.context.events)o.type===J.IncrementalSnapshot&&o.data.source===Z.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(o.data,o)),("commands"in o.data?o.data.commands:[o.data]).forEach(r=>{this.preloadImages(r,o)}));return Promise.all(n)})}preloadImages(e,n){if(e.property==="drawImage"&&typeof e.args[0]=="string"&&!this.imageMap.has(n)){const o=document.createElement("canvas"),r=o.getContext("2d"),i=r==null?void 0:r.createImageData(o.width,o.height);i==null||i.data,JSON.parse(e.args[0]),r==null||r.putImageData(i,0,0)}}deserializeAndPreloadCanvasEvents(e,n){return _e(this,void 0,void 0,function*(){if(!this.canvasEventMap.has(n)){const o={isUnchanged:!0};if("commands"in e){const r=yield Promise.all(e.commands.map(i=>_e(this,void 0,void 0,function*(){const s=yield Promise.all(i.args.map(Se(this.imageMap,null,o)));return Object.assign(Object.assign({},i),{args:s})})));o.isUnchanged===!1&&this.canvasEventMap.set(n,Object.assign(Object.assign({},e),{commands:r}))}else{const r=yield Promise.all(e.args.map(Se(this.imageMap,null,o)));o.isUnchanged===!1&&this.canvasEventMap.set(n,Object.assign(Object.assign({},e),{args:r}))}}})}applyIncremental(e,n){var o,r,i;const{data:s}=e;switch(s.source){case Z.Mutation:try{this.applyMutation(s,n)}catch(a){this.warn(`Exception in mutation ${a.message||a}`,s)}break;case Z.Drag:case Z.TouchMove:case Z.MouseMove:if(n){const a=s.positions[s.positions.length-1];this.mousePos={x:a.x,y:a.y,id:a.id,debugData:s}}else s.positions.forEach(a=>{const l={doAction:()=>{this.moveAndHover(a.x,a.y,a.id,n,s)},delay:a.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(l)}),this.timer.addAction({doAction(){},delay:e.delay-((o=s.positions[0])===null||o===void 0?void 0:o.timeOffset)});break;case Z.MouseInteraction:{if(s.id===-1||n)break;const a=new Event(le[s.type].toLowerCase()),l=this.mirror.getNode(s.id);if(!l)return this.debugNodeNotFound(s,s.id);this.emitter.emit(Y.MouseInteraction,{type:s.type,target:l});const{triggerFocus:u}=this.config;switch(s.type){case le.Blur:"blur"in l&&l.blur();break;case le.Focus:u&&l.focus&&l.focus({preventScroll:!0});break;case le.Click:case le.TouchStart:case le.TouchEnd:n?(s.type===le.TouchStart?this.touchActive=!0:s.type===le.TouchEnd&&(this.touchActive=!1),this.mousePos={x:s.x,y:s.y,id:s.id,debugData:s}):(s.type===le.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(s.x,s.y,s.id,n,s),s.type===le.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):s.type===le.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):s.type===le.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case le.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:l.dispatchEvent(a)}break}case Z.Scroll:if(s.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);a.scrollData=s;break}this.applyScroll(s,n);break;case Z.ViewportResize:this.emitter.emit(Y.Resize,{width:s.width,height:s.height});break;case Z.Input:if(s.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);a.inputData=s;break}this.applyInput(s);break;case Z.MediaInteraction:{const a=this.usingVirtualDom?this.virtualDom.mirror.getNode(s.id):this.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);const l=a;try{s.currentTime&&(l.currentTime=s.currentTime),s.volume&&(l.volume=s.volume),s.muted&&(l.muted=s.muted),s.type===1&&l.pause(),s.type===0&&l.play(),s.type===4&&(l.playbackRate=s.playbackRate)}catch(u){this.config.showWarning&&console.warn(`Failed to replay media interactions: ${u.message||u}`)}break}case Z.StyleSheetRule:case Z.StyleDeclaration:this.usingVirtualDom?s.styleId?this.constructedStyleMutations.push(s):s.id&&((r=this.virtualDom.mirror.getNode(s.id))===null||r===void 0||r.rules.push(s)):this.applyStyleSheetMutation(s);break;case Z.CanvasMutation:if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);a.canvasMutations.push({event:e,mutation:s})}else{const a=this.mirror.getNode(s.id);if(!a)return this.debugNodeNotFound(s,s.id);ln({event:e,mutation:s,target:a,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break;case Z.Font:try{const a=new FontFace(s.family,s.buffer?new Uint8Array(JSON.parse(s.fontSource)):s.fontSource,s.descriptors);(i=this.iframe.contentDocument)===null||i===void 0||i.fonts.add(a)}catch(a){this.config.showWarning&&console.warn(a)}break;case Z.Selection:if(n){this.lastSelectionData=s;break}this.applySelection(s);break;case Z.AdoptedStyleSheet:this.usingVirtualDom?this.adoptedStyleSheets.push(s):this.applyAdoptedStyleSheet(s)}}applyMutation(e,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,hr(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const l in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[l],c=Zn(u.node,this.virtualDom,this.mirror);c&&(u.node=c)}catch(u){this.config.showWarning&&console.warn(u)}const o=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes.forEach(l=>{var u;const c=o.getNode(l.id);if(!c)return e.removes.find(h=>h.id===l.parentId)?void 0:this.warnNodeNotFound(e,l.id);let d=o.getNode(l.parentId);if(!d)return this.warnNodeNotFound(e,l.parentId);if(l.isShadow&&nt(d)&&(d=d.shadowRoot),o.removeNodeFromMap(c),d)try{d.removeChild(c),this.usingVirtualDom&&c.nodeName==="#text"&&d.nodeName==="STYLE"&&((u=d.rules)===null||u===void 0?void 0:u.length)>0&&(d.rules=[])}catch(h){if(!(h instanceof DOMException))throw h;this.warn("parent could not remove child in mutation",d,c,e)}});const r=Object.assign({},this.legacy_missingNodeRetryMap),i=[],s=l=>{var u;if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");let c=o.getNode(l.parentId);if(!c)return l.node.type===se.Document?this.newDocumentQueue.push(l):i.push(l);l.node.isShadow&&(nt(c)||c.attachShadow({mode:"open"}),c=c.shadowRoot);let d=null,h=null;if(l.previousId&&(d=o.getNode(l.previousId)),l.nextId&&(h=o.getNode(l.nextId)),(m=>{let v=null;return m.nextId&&(v=o.getNode(m.nextId)),m.nextId!==null&&m.nextId!==void 0&&m.nextId!==-1&&!v})(l))return i.push(l);if(l.node.rootId&&!o.getNode(l.node.rootId))return;const f=l.node.rootId?o.getNode(l.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(vt(c,o))return void this.attachDocumentToIframe(l,c);const p=(m,v)=>{for(const E of this.config.plugins||[])E.onBuild&&E.onBuild(m,{id:v,replayer:this})},g=Je(l.node,{doc:f,mirror:o,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:p});if(l.previousId===-1||l.nextId===-1)return void(r[l.node.id]={node:g,mutation:l});const C=o.getMeta(c);if(C&&C.type===se.Element&&C.tagName==="textarea"&&l.node.type===se.Text){const m=Array.isArray(c.childNodes)?c.childNodes:Array.from(c.childNodes);for(const v of m)v.nodeType===c.TEXT_NODE&&c.removeChild(v)}if(d&&d.nextSibling&&d.nextSibling.parentNode)c.insertBefore(g,d.nextSibling);else if(h&&h.parentNode)c.contains(h)?c.insertBefore(g,h):c.insertBefore(g,null);else{if(c===f)for(;f.firstChild;)f.removeChild(f.firstChild);c.appendChild(g)}if(p(g,l.node.id),this.usingVirtualDom&&g.nodeName==="#text"&&c.nodeName==="STYLE"&&((u=c.rules)===null||u===void 0?void 0:u.length)>0&&(c.rules=[]),vt(g,this.mirror)){const m=this.mirror.getId(g),v=this.newDocumentQueue.find(E=>E.parentId===m);v&&(this.attachDocumentToIframe(v,g),this.newDocumentQueue=this.newDocumentQueue.filter(E=>E!==v))}(l.previousId||l.nextId)&&this.legacy_resolveMissingNode(r,c,g,l)};e.adds.forEach(l=>{s(l)});const a=Date.now();for(;i.length;){const l=Yo(i);if(i.length=0,Date.now()-a>500){this.warn("Timeout in the loop, please check the resolve tree data:",l);break}for(const u of l)o.getNode(u.value.parentId)?Fn(u,c=>{s(c)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(r).length&&Object.assign(this.legacy_missingNodeRetryMap,r),function(l){const u=new Set,c=[];for(let d=l.length;d--;){const h=l[d];u.has(h.id)||(c.push(h),u.add(h.id))}return c}(e.texts).forEach(l=>{var u;const c=o.getNode(l.id);if(!c)return e.removes.find(d=>d.id===l.id)?void 0:this.warnNodeNotFound(e,l.id);if(c.textContent=l.value,this.usingVirtualDom){const d=c.parentNode;((u=d==null?void 0:d.rules)===null||u===void 0?void 0:u.length)>0&&(d.rules=[])}}),e.attributes.forEach(l=>{const u=o.getNode(l.id);if(!u)return e.removes.find(c=>c.id===l.id)?void 0:this.warnNodeNotFound(e,l.id);for(const c in l.attributes)if(typeof c=="string"){const d=l.attributes[c];if(d===null)u.removeAttribute(c);else if(typeof d=="string")try{if(c==="_cssText"&&(u.nodeName==="LINK"||u.nodeName==="STYLE"))try{const h=o.getMeta(u);Object.assign(h.attributes,l.attributes);const f=Je(h,{doc:u.ownerDocument,mirror:o,skipChild:!0,hackCss:!0,cache:this.cache}),p=u.nextSibling,g=u.parentNode;if(f&&g){g.removeChild(u),g.insertBefore(f,p),o.replace(l.id,f);break}}catch{}u.setAttribute(c,d)}catch(h){this.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",h)}else if(c==="style"){const h=d,f=u;for(const p in h)if(h[p]===!1)f.style.removeProperty(p);else if(h[p]instanceof Array){const g=h[p];f.style.setProperty(p,g[0],g[1])}else{const g=h[p];f.style.setProperty(p,g)}}}})}applyScroll(e,n){var o,r;const i=this.mirror.getNode(e.id);if(!i)return this.debugNodeNotFound(e,e.id);const s=this.mirror.getMeta(i);if(i===this.iframe.contentDocument)(o=this.iframe.contentWindow)===null||o===void 0||o.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"});else if((s==null?void 0:s.type)===se.Document)(r=i.defaultView)===null||r===void 0||r.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"});else try{i.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(e){const n=this.mirror.getNode(e.id);if(!n)return this.debugNodeNotFound(e,e.id);try{n.checked=e.isChecked,n.value=e.text}catch{}}applySelection(e){try{const n=new Set,o=e.ranges.map(({start:r,startOffset:i,end:s,endOffset:a})=>{const l=this.mirror.getNode(r),u=this.mirror.getNode(s);if(!l||!u)return;const c=new Range;c.setStart(l,i),c.setEnd(u,a);const d=l.ownerDocument,h=d==null?void 0:d.getSelection();return h&&n.add(h),{range:c,selection:h}});n.forEach(r=>r.removeAllRanges()),o.forEach(r=>{var i;return r&&((i=r.selection)===null||i===void 0?void 0:i.addRange(r.range))})}catch{}}applyStyleSheetMutation(e){var n;let o=null;e.styleId?o=this.styleMirror.getStyle(e.styleId):e.id&&(o=((n=this.mirror.getNode(e.id))===null||n===void 0?void 0:n.sheet)||null),o&&(e.source===Z.StyleSheetRule?this.applyStyleSheetRule(e,o):e.source===Z.StyleDeclaration&&this.applyStyleDeclaration(e,o))}applyStyleSheetRule(e,n){var o,r,i,s;if((o=e.adds)===null||o===void 0||o.forEach(({rule:a,index:l})=>{try{if(Array.isArray(l)){const{positions:u,index:c}=zt(l);Ke(n.cssRules,u).insertRule(a,c)}else{const u=l===void 0?void 0:Math.min(l,n.cssRules.length);n==null||n.insertRule(a,u)}}catch{}}),(r=e.removes)===null||r===void 0||r.forEach(({index:a})=>{try{if(Array.isArray(a)){const{positions:l,index:u}=zt(a);Ke(n.cssRules,l).deleteRule(u||0)}else n==null||n.deleteRule(a)}catch{}}),e.replace)try{(i=n.replace)===null||i===void 0||i.call(n,e.replace)}catch{}if(e.replaceSync)try{(s=n.replaceSync)===null||s===void 0||s.call(n,e.replaceSync)}catch{}}applyStyleDeclaration(e,n){e.set&&Ke(n.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&Ke(n.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var n;const o=this.mirror.getNode(e.id);if(!o)return;(n=e.styles)===null||n===void 0||n.forEach(s=>{var a;let l=null,u=null;if(nt(o)?u=((a=o.ownerDocument)===null||a===void 0?void 0:a.defaultView)||null:o.nodeName==="#document"&&(u=o.defaultView),u)try{l=new u.CSSStyleSheet,this.styleMirror.add(l,s.styleId),this.applyStyleSheetRule({source:Z.StyleSheetRule,adds:s.rules},l)}catch{}});let r=0;const i=(s,a)=>{const l=a.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);nt(s)?s.shadowRoot.adoptedStyleSheets=l:s.nodeName==="#document"&&(s.adoptedStyleSheets=l),l.length!==a.length&&r<10&&(setTimeout(()=>i(s,a),0+100*r),r++)};i(o,e.styleIds)}legacy_resolveMissingNode(e,n,o,r){const{previousId:i,nextId:s}=r,a=i&&e[i],l=s&&e[s];if(a){const{node:u,mutation:c}=a;n.insertBefore(u,o),delete e[c.node.id],delete this.legacy_missingNodeRetryMap[c.node.id],(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(e,n,u,c)}if(l){const{node:u,mutation:c}=l;n.insertBefore(u,o.nextSibling),delete e[c.node.id],delete this.legacy_missingNodeRetryMap[c.node.id],(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(e,n,u,c)}}moveAndHover(e,n,o,r,i){const s=this.mirror.getNode(o);if(!s)return this.debugNodeNotFound(i,o);const a=Bn(s,this.iframe),l=e*a.absoluteScale+a.x,u=n*a.absoluteScale+a.y;this.mouse.style.left=`${l}px`,this.mouse.style.top=`${u}px`,r||this.drawMouseTail({x:l,y:u}),this.hoverElements(s)}drawMouseTail(e){if(!this.mouseTail)return;const{lineCap:n,lineWidth:o,strokeStyle:r,duration:i}=this.config.mouseTail===!0?At:Object.assign({},At,this.config.mouseTail),s=()=>{if(!this.mouseTail)return;const a=this.mouseTail.getContext("2d");a&&this.tailPositions.length&&(a.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),a.beginPath(),a.lineWidth=o,a.lineCap=n,a.strokeStyle=r,a.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(l=>a.lineTo(l.x,l.y)),a.stroke())};this.tailPositions.push(e),s(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(a=>a!==e),s()},i/this.speedService.state.context.timer.speed)}hoverElements(e){var n;(n=this.iframe.contentDocument)===null||n===void 0||n.querySelectorAll(".\\:hover").forEach(r=>{r.classList.remove(":hover")});let o=e;for(;o;)o.classList&&o.classList.add(":hover"),o=o.parentElement}isUserInteraction(e){return e.type===J.IncrementalSnapshot&&e.data.source>Z.Mutation&&e.data.source<=Z.Input}backToNormal(){this.nextUserInteractionEvent=null,this.speedService.state.matches("normal")||(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(Y.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,n){this.warn(`Node with id '${n}' not found. `,e)}warnCanvasMutationFailed(e,n){this.warn("Has error on canvas update",n,"canvas mutation:",e)}debugNodeNotFound(e,n){this.debug("[replayer]",`Node with id '${n}' not found. `,e)}warn(...e){this.config.showWarning&&console.warn("[replayer]",...e)}debug(...e){this.config.showDebug&&console.log("[replayer]",...e)}}function un(t){let e="";return Object.keys(t).forEach(n=>{e+=`${n}: ${t[n]};`}),e}function Ze(t,e=2){let n=String(t);const o=Math.pow(10,e-1);if(t<o)for(;String(o).length>n.length;)n=`0${t}`;return n}function rt(t){if(t<=0)return"00:00";const e=Math.floor(t/36e5);t%=36e5;const n=Math.floor(t/6e4);t%=6e4;const o=Math.floor(t/1e3);return e?`${Ze(e)}:${Ze(n)}:${Ze(o)}`:`${Ze(n)}:${Ze(o)}`}function dn(){let t=!1;return["fullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement"].forEach(e=>{e in document&&(t=t||!!document[e])}),t}function hn(t){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(t)]}function Mr(t){return t.type===J.IncrementalSnapshot&&t.data.source>Z.Mutation&&t.data.source<=Z.Input}function Rr(t){let e,n,o,r,i,s,a,l,u;return{c(){e=re("div"),n=re("input"),o=ce(),r=re("label"),i=ce(),s=re("span"),a=ke(t[3]),k(n,"type","checkbox"),k(n,"id",t[2]),n.disabled=t[1],k(n,"class","svelte-9brlez"),k(r,"for",t[2]),k(r,"class","svelte-9brlez"),k(s,"class","label svelte-9brlez"),k(e,"class","switch svelte-9brlez"),Ve(e,"disabled",t[1])},m(c,d){we(c,e,d),P(e,n),n.checked=t[0],P(e,o),P(e,r),P(e,i),P(e,s),P(s,a),l||(u=ze(n,"change",t[4]),l=!0)},p(c,[d]){4&d&&k(n,"id",c[2]),2&d&&(n.disabled=c[1]),1&d&&(n.checked=c[0]),4&d&&k(r,"for",c[2]),8&d&&ct(a,c[3]),2&d&&Ve(e,"disabled",c[1])},i:at,o:at,d(c){c&&ve(e),l=!1,u()}}}function kr(t,e,n){let{disabled:o}=e,{checked:r}=e,{id:i}=e,{label:s}=e;return t.$$set=a=>{"disabled"in a&&n(1,o=a.disabled),"checked"in a&&n(0,r=a.checked),"id"in a&&n(2,i=a.id),"label"in a&&n(3,s=a.label)},[r,o,i,s,function(){r=this.checked,n(0,r)}]}class xr extends Ot{constructor(e){super(),Bt(this,e,kr,Rr,kt,{disabled:1,checked:0,id:2,label:3})}}function pn(t,e,n){const o=t.slice();return o[39]=e[n],o}function gn(t,e,n){const o=t.slice();return o[42]=e[n],o}function mn(t,e,n){const o=t.slice();return o[45]=e[n],o}function fn(t){let e,n,o,r,i,s,a,l,u,c,d,h,f,p,g,C,m,v,E,A,T,O,F,N,b,x,w=rt(t[6])+"",y=rt(t[8].totalTime)+"",R=t[14],_=[];for(let S=0;S<R.length;S+=1)_[S]=vn(mn(t,R,S));let Q=t[9],G=[];for(let S=0;S<Q.length;S+=1)G[S]=yn(gn(t,Q,S));function I(S,K){return S[7]==="playing"?Br:Fr}let L=I(t),$=L(t),q=t[3],te=[];for(let S=0;S<q.length;S+=1)te[S]=Cn(pn(t,q,S));function ge(S){t[30](S)}let oe={id:"skip",disabled:t[10]==="skipping",label:"skip inactive"};return t[0]!==void 0&&(oe.checked=t[0]),A=new xr({props:oe}),Ee.push(()=>function(S,K,z){const me=S.$$.props[K];me!==void 0&&(S.$$.bound[me]=z,z(S.$$.ctx[me]))}(A,"checked",ge)),{c(){e=re("div"),n=re("div"),o=re("span"),r=ke(w),i=ce(),s=re("div"),a=re("div"),l=ce();for(let S=0;S<_.length;S+=1)_[S].c();u=ce();for(let S=0;S<G.length;S+=1)G[S].c();c=ce(),d=re("div"),h=ce(),f=re("span"),p=ke(y),g=ce(),C=re("div"),m=re("button"),$.c(),v=ce();for(let S=0;S<te.length;S+=1)te[S].c();E=ce(),Rn(A.$$.fragment),O=ce(),F=re("button"),F.innerHTML=`<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16"><defs><style type="text/css"></style></defs><path d="M916 380c-26.4 0-48-21.6-48-48L868 223.2 613.6 477.6c-18.4
            18.4-48.8 18.4-68 0-18.4-18.4-18.4-48.8 0-68L800 156 692 156c-26.4
            0-48-21.6-48-48 0-26.4 21.6-48 48-48l224 0c26.4 0 48 21.6 48 48l0
            224C964 358.4 942.4 380 916 380zM231.2 860l108.8 0c26.4 0 48 21.6 48
            48s-21.6 48-48 48l-224 0c-26.4 0-48-21.6-48-48l0-224c0-26.4 21.6-48
            48-48 26.4 0 48 21.6 48 48L164 792l253.6-253.6c18.4-18.4 48.8-18.4
            68 0 18.4 18.4 18.4 48.8 0 68L231.2 860z" p-id="1286"></path></svg>`,k(o,"class","rr-timeline__time svelte-19ke1iv"),k(a,"class","rr-progress__step svelte-19ke1iv"),ne(a,"width",t[13]),k(d,"class","rr-progress__handler svelte-19ke1iv"),ne(d,"left",t[13]),k(s,"class","rr-progress svelte-19ke1iv"),Ve(s,"disabled",t[10]==="skipping"),k(f,"class","rr-timeline__time svelte-19ke1iv"),k(n,"class","rr-timeline svelte-19ke1iv"),k(m,"class","svelte-19ke1iv"),k(F,"class","svelte-19ke1iv"),k(C,"class","rr-controller__btns svelte-19ke1iv"),k(e,"class","rr-controller svelte-19ke1iv")},m(S,K){we(S,e,K),P(e,n),P(n,o),P(o,r),P(n,i),P(n,s),P(s,a),t[27](a),P(s,l);for(let z=0;z<_.length;z+=1)_[z].m(s,null);P(s,u);for(let z=0;z<G.length;z+=1)G[z].m(s,null);P(s,c),P(s,d),t[28](s),P(n,h),P(n,f),P(f,p),P(e,g),P(e,C),P(C,m),$.m(m,null),P(C,v);for(let z=0;z<te.length;z+=1)te[z].m(C,null);P(C,E),xt(A,C,null),P(C,O),P(C,F),N=!0,b||(x=[ze(s,"click",t[16]),ze(m,"click",t[4]),ze(F,"click",t[31])],b=!0)},p(S,K){if((!N||64&K[0])&&w!==(w=rt(S[6])+"")&&ct(r,w),(!N||8192&K[0])&&ne(a,"width",S[13]),16384&K[0]){let B;for(R=S[14],B=0;B<R.length;B+=1){const de=mn(S,R,B);_[B]?_[B].p(de,K):(_[B]=vn(de),_[B].c(),_[B].m(s,u))}for(;B<_.length;B+=1)_[B].d(1);_.length=R.length}if(512&K[0]){let B;for(Q=S[9],B=0;B<Q.length;B+=1){const de=gn(S,Q,B);G[B]?G[B].p(de,K):(G[B]=yn(de),G[B].c(),G[B].m(s,c))}for(;B<G.length;B+=1)G[B].d(1);G.length=Q.length}if((!N||8192&K[0])&&ne(d,"left",S[13]),1024&K[0]&&Ve(s,"disabled",S[10]==="skipping"),(!N||256&K[0])&&y!==(y=rt(S[8].totalTime)+"")&&ct(p,y),L!==(L=I(S))&&($.d(1),$=L(S),$&&($.c(),$.m(m,null))),1066&K[0]){let B;for(q=S[3],B=0;B<q.length;B+=1){const de=pn(S,q,B);te[B]?te[B].p(de,K):(te[B]=Cn(de),te[B].c(),te[B].m(C,E))}for(;B<te.length;B+=1)te[B].d(1);te.length=q.length}const z={};var me;1024&K[0]&&(z.disabled=S[10]==="skipping"),!T&&1&K[0]&&(T=!0,z.checked=S[0],me=()=>T=!1,St.push(me)),A.$set(z)},i(S){N||(Ae(A.$$.fragment,S),N=!0)},o(S){Le(A.$$.fragment,S),N=!1},d(S){S&&ve(e),t[27](null),mt(_,S),mt(G,S),t[28](null),$.d(),mt(te,S),Ft(A),b=!1,We(x)}}}function vn(t){let e,n;return{c(){e=re("div"),k(e,"title",n=t[45].name),ne(e,"width",t[45].width),ne(e,"height","4px"),ne(e,"position","absolute"),ne(e,"background",t[45].background),ne(e,"left",t[45].position)},m(o,r){we(o,e,r)},p(o,r){16384&r[0]&&n!==(n=o[45].name)&&k(e,"title",n),16384&r[0]&&ne(e,"width",o[45].width),16384&r[0]&&ne(e,"background",o[45].background),16384&r[0]&&ne(e,"left",o[45].position)},d(o){o&&ve(e)}}}function yn(t){let e,n;return{c(){e=re("div"),k(e,"title",n=t[42].name),ne(e,"width","10px"),ne(e,"height","5px"),ne(e,"position","absolute"),ne(e,"top","2px"),ne(e,"transform","translate(-50%, -50%)"),ne(e,"background",t[42].background),ne(e,"left",t[42].position)},m(o,r){we(o,e,r)},p(o,r){512&r[0]&&n!==(n=o[42].name)&&k(e,"title",n),512&r[0]&&ne(e,"background",o[42].background),512&r[0]&&ne(e,"left",o[42].position)},d(o){o&&ve(e)}}}function Fr(t){let e,n;return{c(){e=lt("svg"),n=lt("path"),k(n,"d",`M170.65984 896l0-768 640 384zM644.66944
              512l-388.66944-233.32864 0 466.65728z`),k(e,"class","icon"),k(e,"viewBox","0 0 1024 1024"),k(e,"version","1.1"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"xmlns:xlink","http://www.w3.org/1999/xlink"),k(e,"width","16"),k(e,"height","16")},m(o,r){we(o,e,r),P(e,n)},d(o){o&&ve(e)}}}function Br(t){let e,n;return{c(){e=lt("svg"),n=lt("path"),k(n,"d",`M682.65984 128q53.00224 0 90.50112 37.49888t37.49888 90.50112l0
              512q0 53.00224-37.49888 90.50112t-90.50112
              37.49888-90.50112-37.49888-37.49888-90.50112l0-512q0-53.00224
              37.49888-90.50112t90.50112-37.49888zM341.34016 128q53.00224 0
              90.50112 37.49888t37.49888 90.50112l0 512q0 53.00224-37.49888
              90.50112t-90.50112
              37.49888-90.50112-37.49888-37.49888-90.50112l0-512q0-53.00224
              37.49888-90.50112t90.50112-37.49888zM341.34016 213.34016q-17.67424
              0-30.16704 12.4928t-12.4928 30.16704l0 512q0 17.67424 12.4928
              30.16704t30.16704 12.4928 30.16704-12.4928
              12.4928-30.16704l0-512q0-17.67424-12.4928-30.16704t-30.16704-12.4928zM682.65984
              213.34016q-17.67424 0-30.16704 12.4928t-12.4928 30.16704l0 512q0
              17.67424 12.4928 30.16704t30.16704 12.4928 30.16704-12.4928
              12.4928-30.16704l0-512q0-17.67424-12.4928-30.16704t-30.16704-12.4928z`),k(e,"class","icon"),k(e,"viewBox","0 0 1024 1024"),k(e,"version","1.1"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"xmlns:xlink","http://www.w3.org/1999/xlink"),k(e,"width","16"),k(e,"height","16")},m(o,r){we(o,e,r),P(e,n)},d(o){o&&ve(e)}}}function Cn(t){let e,n,o,r,i,s,a=t[39]+"";function l(){return t[29](t[39])}return{c(){e=re("button"),n=ke(a),o=ke("x"),e.disabled=r=t[10]==="skipping",k(e,"class","svelte-19ke1iv"),Ve(e,"active",t[39]===t[1]&&t[10]!=="skipping")},m(u,c){we(u,e,c),P(e,n),P(e,o),i||(s=ze(e,"click",l),i=!0)},p(u,c){t=u,8&c[0]&&a!==(a=t[39]+"")&&ct(n,a),1024&c[0]&&r!==(r=t[10]==="skipping")&&(e.disabled=r),1034&c[0]&&Ve(e,"active",t[39]===t[1]&&t[10]!=="skipping")},d(u){u&&ve(e),i=!1,s()}}}function Or(t){let e,n,o=t[2]&&fn(t);return{c(){o&&o.c(),e=ke("")},m(r,i){o&&o.m(r,i),we(r,e,i),n=!0},p(r,i){r[2]?o?(o.p(r,i),4&i[0]&&Ae(o,1)):(o=fn(r),o.c(),Ae(o,1),o.m(e.parentNode,e)):o&&(_n(),Le(o,1,1,()=>{o=null}),Mn())},i(r){n||(Ae(o),n=!0)},o(r){Le(o),n=!1},d(r){o&&o.d(r),r&&ve(e)}}}function In(t,e,n){return(100-(e-n)/(e-t)*100).toFixed(2)}function Vr(t,e,n){const o=Oo();let r,i,s,a,l,u,c,d,h,f,{replayer:p}=e,{showController:g}=e,{autoPlay:C}=e,{skipInactive:m}=e,{speedOption:v}=e,{speed:E=v.length?v[0]:1}=e,{tags:A={}}=e,{inactiveColor:T}=e,O=0,F=null,N=!1,b=null;const x=()=>{F&&(cancelAnimationFrame(F),F=null)},w=()=>{r==="paused"&&(l?(p.play(),l=!1):p.play(O))},y=()=>{r==="playing"&&(p.pause(),N=!1)},R=(I,L)=>{n(6,O=I),N=!1,(typeof L=="boolean"?L:r==="playing")?p.play(I):p.pause(I)},_=(I,L,$=!1,q)=>{b=$?{start:I,end:L}:null,n(6,O=I),N=L,u=q,p.play(I)},Q=I=>{let L=r==="playing";n(1,E=I),L&&p.pause(),p.setConfig({speed:E}),L&&p.play(O)};var G;return Nn(()=>{n(7,r=p.service.state.value),n(10,i=p.speedService.state.value),p.on("state-change",I=>{const{player:L,speed:$}=I;if(L!=null&&L.value&&r!==L.value)switch(n(7,r=L.value),r){case"playing":x(),F=requestAnimationFrame(function q(){n(6,O=p.getCurrentTime()),N&&O>=N&&(b?_(b.start,b.end,!0,void 0):(p.pause(),u&&(u(),u=null))),O<c.totalTime&&(F=requestAnimationFrame(q))});break;case"paused":x()}$!=null&&$.value&&i!==$.value&&n(10,i=$.value)}),p.on("finish",()=>{l=!0,u&&(u(),u=null)}),C&&p.play()}),G=()=>{m!==p.config.skipInactive&&p.setConfig({skipInactive:m})},gt().$$.after_update.push(G),Tn(()=>{p.pause(),x()}),t.$$set=I=>{"replayer"in I&&n(17,p=I.replayer),"showController"in I&&n(2,g=I.showController),"autoPlay"in I&&n(18,C=I.autoPlay),"skipInactive"in I&&n(0,m=I.skipInactive),"speedOption"in I&&n(3,v=I.speedOption),"speed"in I&&n(1,E=I.speed),"tags"in I&&n(19,A=I.tags),"inactiveColor"in I&&n(20,T=I.inactiveColor)},t.$$.update=()=>{if(64&t.$$.dirty[0]&&o("ui-update-current-time",{payload:O}),128&t.$$.dirty[0]&&o("ui-update-player-state",{payload:r}),131072&t.$$.dirty[0]&&n(8,c=p.getMetaData()),320&t.$$.dirty[0]){const I=Math.min(1,O/c.totalTime);n(13,d=100*I+"%"),o("ui-update-progress",{payload:I})}655360&t.$$.dirty[0]&&n(9,h=(()=>{const{context:I}=p.service.state,L=I.events.length,$=I.events[0].timestamp,q=I.events[L-1].timestamp,te=[];return I.events.forEach(ge=>{if(ge.type===J.Custom){const oe={name:ge.data.tag,background:A[ge.data.tag]||"rgb(73, 80, 246)",position:`${In($,q,ge.timestamp)}%`};te.push(oe)}}),te})()),1179648&t.$$.dirty[0]&&n(14,f=(()=>{try{const{context:I}=p.service.state,L=I.events.length,$=I.events[0].timestamp,q=I.events[L-1].timestamp,te=function(oe){const S=[];let K=oe[0].timestamp;for(const z of oe)Mr(z)&&(z.timestamp-K>1e4&&S.push([K,z.timestamp]),K=z.timestamp);return S}(I.events),ge=(oe,S,K,z)=>((z-K)/(S-oe)*100).toFixed(2);return te.map(oe=>({name:"inactive period",background:T,position:`${In($,q,oe[0])}%`,width:`${ge($,q,oe[0],oe[1])}%`}))}catch{return[]}})())},[m,E,g,v,()=>{switch(r){case"playing":y();break;case"paused":w()}},Q,O,r,c,h,i,s,a,d,f,o,I=>{if(i==="skipping")return;const L=s.getBoundingClientRect();let $=(I.clientX-L.left)/L.width;$<0?$=0:$>1&&($=1);const q=c.totalTime*$;l=!1,R(q)},p,C,A,T,w,y,R,_,()=>{n(0,m=!m)},()=>Promise.resolve().then(()=>{n(8,c=p.getMetaData())}),function(I){Ee[I?"unshift":"push"](()=>{a=I,n(12,a)})},function(I){Ee[I?"unshift":"push"](()=>{s=I,n(11,s)})},I=>Q(I),function(I){m=I,n(0,m)},()=>o("fullscreen")]}class Lr extends Ot{constructor(e){super(),Bt(this,e,Vr,Or,kt,{replayer:17,showController:2,autoPlay:18,skipInactive:0,speedOption:3,speed:1,tags:19,inactiveColor:20,toggle:4,play:21,pause:22,goto:23,playRange:24,setSpeed:5,toggleSkipInactive:25,triggerUpdateMeta:26},null,[-1,-1])}get toggle(){return this.$$.ctx[4]}get play(){return this.$$.ctx[21]}get pause(){return this.$$.ctx[22]}get goto(){return this.$$.ctx[23]}get playRange(){return this.$$.ctx[24]}get setSpeed(){return this.$$.ctx[5]}get toggleSkipInactive(){return this.$$.ctx[25]}get triggerUpdateMeta(){return this.$$.ctx[26]}}function bn(t){let e,n,o={replayer:t[7],showController:t[3],autoPlay:t[1],speedOption:t[2],skipInactive:t[0],tags:t[4],inactiveColor:t[5]};return e=new Lr({props:o}),t[32](e),e.$on("fullscreen",t[33]),{c(){Rn(e.$$.fragment)},m(r,i){xt(e,r,i),n=!0},p(r,i){const s={};128&i[0]&&(s.replayer=r[7]),8&i[0]&&(s.showController=r[3]),2&i[0]&&(s.autoPlay=r[1]),4&i[0]&&(s.speedOption=r[2]),1&i[0]&&(s.skipInactive=r[0]),16&i[0]&&(s.tags=r[4]),32&i[0]&&(s.inactiveColor=r[5]),e.$set(s)},i(r){n||(Ae(e.$$.fragment,r),n=!0)},o(r){Le(e.$$.fragment,r),n=!1},d(r){t[32](null),Ft(e,r)}}}function $r(t){let e,n,o,r,i=t[7]&&bn(t);return{c(){e=re("div"),n=re("div"),o=ce(),i&&i.c(),k(n,"class","rr-player__frame"),k(n,"style",t[11]),k(e,"class","rr-player"),k(e,"style",t[12])},m(s,a){we(s,e,a),P(e,n),t[31](n),P(e,o),i&&i.m(e,null),t[34](e),r=!0},p(s,a){(!r||2048&a[0])&&k(n,"style",s[11]),s[7]?i?(i.p(s,a),128&a[0]&&Ae(i,1)):(i=bn(s),i.c(),Ae(i,1),i.m(e,null)):i&&(_n(),Le(i,1,1,()=>{i=null}),Mn()),(!r||4096&a[0])&&k(e,"style",s[12])},i(s){r||(Ae(i),r=!0)},o(s){Le(i),r=!1},d(s){s&&ve(e),t[31](null),i&&i.d(),t[34](null)}}}function Ur(t,e,n){let o,{width:r=1024}=e,{height:i=576}=e,{maxScale:s=1}=e,{events:a=[]}=e,{skipInactive:l=!0}=e,{autoPlay:u=!0}=e,{speedOption:c=[1,2,4,8]}=e,{speed:d=1}=e,{showController:h=!0}=e,{tags:f={}}=e,{inactiveColor:p="#D4D4D4"}=e,g,C,m,v,E,A,T=r,O=i;const F=(b,x)=>{const w=[r/x.width,i/x.height];s&&w.push(s),b.style.transform=`scale(${Math.min(...w)})translate(-50%, -50%)`},N=()=>{var b;g&&(dn()?document.exitFullscreen?document.exitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():(b=g).requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.msRequestFullscreen&&b.msRequestFullscreen())};return Nn(()=>{if(c!==void 0&&hn(c)!=="array")throw new Error("speedOption must be array");if(c.forEach(x=>{if(hn(x)!=="number")throw new Error("item of speedOption must be number")}),c.indexOf(d)<0)throw new Error(`speed must be one of speedOption,
        current config:
        {
          ...
          speed: ${d},
          speedOption: [${c.toString()}]
          ...
        }
        `);var b;n(7,o=new _r(a,Object.assign({speed:d,root:C,unpackFn:Ir},e))),o.on("resize",x=>{F(o.wrapper,x)}),b=()=>{dn()?setTimeout(()=>{T=r,O=i,n(13,r=g.offsetWidth),n(14,i=g.offsetHeight-(h?80:0)),F(o.wrapper,{width:o.iframe.offsetWidth,height:o.iframe.offsetHeight})},0):(n(13,r=T),n(14,i=O),F(o.wrapper,{width:o.iframe.offsetWidth,height:o.iframe.offsetHeight}))},document.addEventListener("fullscreenchange",b),document.addEventListener("webkitfullscreenchange",b),document.addEventListener("mozfullscreenchange",b),document.addEventListener("MSFullscreenChange",b),m=()=>{document.removeEventListener("fullscreenchange",b),document.removeEventListener("webkitfullscreenchange",b),document.removeEventListener("mozfullscreenchange",b),document.removeEventListener("MSFullscreenChange",b)}}),Tn(()=>{m&&m()}),t.$$set=b=>{n(39,e=$t($t({},e),Wt(b))),"width"in b&&n(13,r=b.width),"height"in b&&n(14,i=b.height),"maxScale"in b&&n(15,s=b.maxScale),"events"in b&&n(16,a=b.events),"skipInactive"in b&&n(0,l=b.skipInactive),"autoPlay"in b&&n(1,u=b.autoPlay),"speedOption"in b&&n(2,c=b.speedOption),"speed"in b&&n(17,d=b.speed),"showController"in b&&n(3,h=b.showController),"tags"in b&&n(4,f=b.tags),"inactiveColor"in b&&n(5,p=b.inactiveColor)},t.$$.update=()=>{24576&t.$$.dirty[0]&&n(11,E=un({width:`${r}px`,height:`${i}px`})),24584&t.$$.dirty[0]&&n(12,A=un({width:`${r}px`,height:`${i+(h?80:0)}px`}))},e=Wt(e),[l,u,c,h,f,p,N,o,g,C,v,E,A,r,i,s,a,d,()=>o.getMirror(),()=>{F(o.wrapper,{width:o.iframe.offsetWidth,height:o.iframe.offsetHeight})},(b,x)=>{switch(o.on(b,x),b){case"ui-update-current-time":case"ui-update-progress":case"ui-update-player-state":v.$on(b,({detail:w})=>x(w))}},b=>{o.addEvent(b),v.triggerUpdateMeta()},()=>o.getMetaData(),()=>o,()=>{v.toggle()},b=>{v.setSpeed(b)},()=>{v.toggleSkipInactive()},()=>{v.play()},()=>{v.pause()},(b,x)=>{v.goto(b,x)},(b,x,w=!1,y)=>{v.playRange(b,x,w,y)},function(b){Ee[b?"unshift":"push"](()=>{C=b,n(9,C)})},function(b){Ee[b?"unshift":"push"](()=>{v=b,n(10,v)})},()=>N(),function(b){Ee[b?"unshift":"push"](()=>{g=b,n(8,g)})}]}class Wr extends Ot{constructor(e){super(),Bt(this,e,Ur,$r,kt,{width:13,height:14,maxScale:15,events:16,skipInactive:0,autoPlay:1,speedOption:2,speed:17,showController:3,tags:4,inactiveColor:5,getMirror:18,triggerResize:19,toggleFullscreen:6,addEventListener:20,addEvent:21,getMetaData:22,getReplayer:23,toggle:24,setSpeed:25,toggleSkipInactive:26,play:27,pause:28,goto:29,playRange:30},null,[-1,-1])}get getMirror(){return this.$$.ctx[18]}get triggerResize(){return this.$$.ctx[19]}get toggleFullscreen(){return this.$$.ctx[6]}get addEventListener(){return this.$$.ctx[20]}get addEvent(){return this.$$.ctx[21]}get getMetaData(){return this.$$.ctx[22]}get getReplayer(){return this.$$.ctx[23]}get toggle(){return this.$$.ctx[24]}get setSpeed(){return this.$$.ctx[25]}get toggleSkipInactive(){return this.$$.ctx[26]}get play(){return this.$$.ctx[27]}get pause(){return this.$$.ctx[28]}get goto(){return this.$$.ctx[29]}get playRange(){return this.$$.ctx[30]}}class Gr extends Wr{constructor(e){super({target:e.target,props:e.data||e.props})}}const Zr={key:0,class:"player-container-wrapper"},Pr={class:"dialog-footer"},Kr=$e({__name:"RrwebPlayerDialog",props:{visible:{type:Boolean},errorId:{}},emits:["update:visible"],setup(t,{emit:e}){const n=t,o=e,r=H(null),i=H(!1),s=H(null),a=H(null),l=Re(()=>{var h;return((h=r.value)==null?void 0:h.payload.rrwebData)&&r.value.payload.rrwebData.length>0}),u=()=>{o("update:visible",!1)},c=async()=>{if(n.errorId)try{i.value=!0,console.log("获取错误详情数据，错误ID:",n.errorId);const h=await Rt(n.errorId);r.value=h,console.log("错误详情数据:",h),h.payload.rrwebData&&h.payload.rrwebData.length>0&&setTimeout(()=>{d()},100)}catch(h){console.error("获取错误详情数据失败:",h),Ce.error("获取错误详情数据失败")}finally{i.value=!1}},d=async()=>{var h;if(!(!l.value||!s.value||!r.value))try{a.value&&(a.value.$destroy(),a.value=null),a.value=new Gr({target:s.value,props:{events:((h=r.value.payload)==null?void 0:h.rrwebData)||[],showController:!0,autoPlay:!1,width:s.value.clientWidth,height:Math.min(window.innerHeight*.6,600)}}),console.log("rrweb播放器初始化成功")}catch(f){console.error("初始化rrweb播放器失败:",f),Ce.error("初始化rrweb播放器失败")}};return Ie(()=>n.visible,h=>{console.log("⭐==>",111),h&&n.errorId?c():!h&&a.value&&(a.value.$destroy(),a.value=null)}),Sn(()=>{}),ho(()=>{a.value&&(a.value.$destroy(),a.value=null)}),(h,f)=>{const p=W("el-empty"),g=W("el-button"),C=W("el-dialog"),m=pt("loading");return j(),De(C,{title:"会话录屏回放",modelValue:n.visible,"onUpdate:modelValue":f[0]||(f[0]=v=>n.visible=v),width:"80%","destroy-on-close":"",onClose:u,class:"rrweb-player-dialog"},{footer:M(()=>[V("span",Pr,[D(g,{onClick:u},{default:M(()=>f[2]||(f[2]=[be("关闭")])),_:1})])]),default:M(()=>[ht((j(),ae("div",null,[l.value?(j(),ae("div",Zr,[V("div",{ref_key:"playerContainer",ref:s,class:"player-container"},null,512)])):i.value?wt("",!0):(j(),De(p,{key:1,description:"暂无会话录屏数据"},{description:M(()=>f[1]||(f[1]=[V("p",null,"该错误事件未包含会话录屏数据",-1),V("p",{class:"empty-tip"},"提示: 确保SDK配置中启用了rrweb插件，并设置了适当的录制模式",-1)])),_:1}))])),[[m,i.value]])]),_:1},8,["modelValue"])}}}),Yr=Ue(Kr,[["__scopeId","data-v-6407ee0b"]]),zr={class:"behavior-info"},Qr={class:"behavior-count"},Jr={class:"behavior-item"},Hr={class:"behavior-type"},Xr={class:"behavior-detail"},jr={key:0,class:"behavior-extra-info"},qr={class:"position-info"},es={class:"dialog-footer"},ts=$e({__name:"BehaviorStackDialog",props:{visible:{type:Boolean},errorId:{}},emits:["update:visible"],setup(t,{emit:e}){const n=t,o=e,r=H(null),i=H(!1),s=Re(()=>{var p;return((p=r.value)==null?void 0:p.payload.behaviorStack)&&r.value.payload.behaviorStack.length>0}),a=Re(()=>!s.value||!r.value?[]:[...r.value.payload.behaviorStack].sort((p,g)=>g.timestamp-p.timestamp)),l=()=>{o("update:visible",!1)},u=async()=>{if(n.errorId)try{i.value=!0,console.log("获取错误详情数据，错误ID:",n.errorId);const p=await Rt(n.errorId);r.value=p,console.log("错误详情数据:",p)}catch(p){console.error("获取错误详情数据失败:",p),Ce.error("获取错误详情数据失败")}finally{i.value=!1}},c=p=>({click:"Pointer",input:"Edit",navigation:"Connection",api:"Link",pageview:"Document",scroll:"Sort",resize:"FullScreen",keypress:"Keyboard"})[p]||"InfoFilled",d=p=>({click:"primary",input:"success",navigation:"warning",api:"danger",pageview:"info",scroll:"",resize:"",keypress:"success"})[p]||"",h=p=>po(new Date(p),"HH:mm:ss.SSS"),f=p=>{switch(p.type){case"click":return`点击了 <${p.element}> 元素 "${p.text||"未知内容"}"`;case"input":return"在输入框中输入了内容";case"navigation":return`从 ${p.from} 导航到 ${p.to}`;case"api":return`${p.method} 请求 ${p.url}，状态码: ${p.status}`;case"pageview":return`访问页面 ${p.url}，标题: ${p.title}`;case"scroll":return`滚动到位置 (${p.position.x}, ${p.position.y})`;case"resize":return"调整窗口大小";case"keypress":return"按下键盘";default:return`${p.type} 行为`}};return Ie(()=>n.visible,p=>{p&&n.errorId&&u()}),(p,g)=>{const C=W("el-alert"),m=W("el-tag"),v=W("el-timeline-item"),E=W("el-timeline"),A=W("el-empty"),T=W("el-button"),O=W("el-dialog"),F=pt("loading");return j(),De(O,{title:"用户行为栈",modelValue:n.visible,"onUpdate:modelValue":g[0]||(g[0]=N=>n.visible=N),width:"80%","destroy-on-close":"",onClose:l,class:"behavior-stack-dialog"},{footer:M(()=>[V("span",es,[D(T,{onClick:l},{default:M(()=>g[2]||(g[2]=[be("关闭")])),_:1})])]),default:M(()=>[ht((j(),ae("div",null,[s.value?(j(),ae(Oe,{key:0},[V("div",zr,[D(C,{title:"用户行为栈记录了错误发生前的用户操作序列",type:"info",description:"通过分析用户行为，可以更好地理解错误发生的上下文和复现路径","show-icon":"",closable:!1,class:"behavior-info-alert"}),V("div",Qr,[D(m,{type:"info",size:"large"},{default:M(()=>[be("共 "+ie(a.value.length)+" 个行为记录",1)]),_:1})])]),D(E,{class:"behavior-timeline"},{default:M(()=>[(j(!0),ae(Oe,null,Xe(a.value,(N,b)=>(j(),De(v,{key:b,type:d(N.type),icon:c(N.type),timestamp:h(N.timestamp),size:"large"},{default:M(()=>[V("div",Jr,[V("div",Hr,[D(m,{size:"small",type:d(N.type)},{default:M(()=>[be(ie(N.type),1)]),_:2},1032,["type"])]),V("div",Xr,ie(f(N)),1),N.type==="click"&&N.position?(j(),ae("div",jr,[V("div",qr," 点击位置: ("+ie(N.position.x)+", "+ie(N.position.y)+") ",1)])):wt("",!0)])]),_:2},1032,["type","icon","timestamp"]))),128))]),_:1})],64)):i.value?wt("",!0):(j(),De(A,{key:1,description:"暂无用户行为记录"},{description:M(()=>g[1]||(g[1]=[V("p",null,"该错误事件未包含用户行为栈数据",-1),V("p",{class:"empty-tip"},"提示: 确保SDK配置中启用了behaviorStack插件，并设置了适当的记录模式",-1)])),_:1}))])),[[F,i.value]])]),_:1},8,["modelValue"])}}}),ns=Ue(ts,[["__scopeId","data-v-70d5d2cd"]]),os={class:"error-table-container"},rs={class:"error-message ellipsis"},ss={class:"error-count"},is={class:"operation-buttons"},as={class:"pagination-container"},ls=$e({__name:"ErrorTable",props:{data:{},total:{},loading:{type:Boolean,default:!1},page:{default:1},pageSize:{default:20},sortBy:{default:"lastSeen_desc"}},emits:["update:page","update:pageSize","update:sortBy","refresh"],setup(t,{emit:e}){const n=t,o=e,r=H(n.page),i=H(n.pageSize),s=H(n.sortBy),a=H(!1),l=H(!1),u=H(!1),c=H("");Ie(()=>n.page,A=>{r.value=A}),Ie(()=>n.pageSize,A=>{i.value=A}),Ie(()=>n.sortBy,A=>{s.value=A});const d=A=>{r.value=A,o("update:page",A),o("refresh")},h=A=>{i.value=A,r.value=1,o("update:pageSize",A),o("update:page",1),o("refresh")},f=({prop:A,order:T})=>{if(!A||!T)return;const F=`${A}_${T==="descending"?"desc":"asc"}`;s.value=F,o("update:sortBy",F),o("refresh")},p=(A,T)=>{T.stopPropagation(),c.value=A.sampleEventId,a.value=!0,console.log("查看源码:",A.sampleEventId)},g=(A,T)=>{T.stopPropagation(),c.value=A.sampleEventId,l.value=!0,console.log("播放录屏:",A.sampleEventId)},C=(A,T)=>{T.stopPropagation(),c.value=A.sampleEventId,u.value=!0,console.log("查看用户行为:",A.sampleEventId)},m=A=>({TypeError:"danger",ReferenceError:"warning",SyntaxError:"info",RangeError:"warning",URIError:"info",EvalError:"danger",InternalError:"danger"})[A]||"info",v=Re(()=>!n.loading&&(!n.data||n.data.length===0)),E=Re(()=>v.value?"暂无错误数据":"");return(A,T)=>{const O=W("el-tag"),F=W("el-table-column"),N=W("Document"),b=W("el-icon"),x=W("el-button"),w=W("el-tooltip"),y=W("VideoPlay"),R=W("List"),_=W("el-table"),Q=W("el-pagination"),G=pt("loading");return j(),ae("div",os,[ht((j(),De(_,{data:A.data,style:{width:"100%"},onSortChange:f,"row-key":"fingerprint",border:"",stripe:"","empty-text":E.value,"highlight-current-row":""},{default:M(()=>[D(F,{prop:"type",label:"错误类型",width:"120"},{default:M(({row:I})=>[D(O,{type:m(I.type),size:"small"},{default:M(()=>[be(ie(I.type),1)]),_:2},1032,["type"])]),_:1}),D(F,{prop:"message",label:"错误信息","min-width":"300","show-overflow-tooltip":""},{default:M(({row:I})=>[V("div",rs,ie(I.message),1)]),_:1}),D(F,{prop:"count",label:"发生次数",align:"center",width:"100",sortable:"custom"},{default:M(({row:I})=>[V("span",ss,ie(I.count),1)]),_:1}),D(F,{prop:"userCount",label:"影响用户数",align:"center",width:"100",sortable:"custom"},{default:M(({row:I})=>[V("span",null,ie(I.userCount),1)]),_:1}),D(F,{prop:"lastSeen",label:"最后发生",align:"center",width:"150",sortable:"custom"},{default:M(({row:I})=>[V("span",null,ie(wn(go)(I.lastSeen)),1)]),_:1}),D(F,{label:"操作",width:"200",align:"center",fixed:"right"},{default:M(({row:I})=>[V("div",is,[D(w,{content:"查看源码",placement:"top"},{default:M(()=>[D(x,{type:"primary",size:"small",circle:"",onClick:L=>p(I,L)},{default:M(()=>[D(b,null,{default:M(()=>[D(N)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),D(w,{content:"播放录屏",placement:"top"},{default:M(()=>[D(x,{type:"success",size:"small",circle:"",onClick:L=>g(I,L)},{default:M(()=>[D(b,null,{default:M(()=>[D(y)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),D(w,{content:"查看用户行为",placement:"top"},{default:M(()=>[D(x,{type:"warning",size:"small",circle:"",onClick:L=>C(I,L)},{default:M(()=>[D(b,null,{default:M(()=>[D(R)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data","empty-text"])),[[G,A.loading]]),V("div",as,[D(Q,{"current-page":r.value,"onUpdate:currentPage":T[0]||(T[0]=I=>r.value=I),"page-size":i.value,"onUpdate:pageSize":T[1]||(T[1]=I=>i.value=I),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:A.total,onSizeChange:h,onCurrentChange:d},null,8,["current-page","page-size","total"])]),D(Fo,{visible:a.value,"onUpdate:visible":T[2]||(T[2]=I=>a.value=I),"error-id":c.value},null,8,["visible","error-id"]),D(Yr,{visible:l.value,"onUpdate:visible":T[3]||(T[3]=I=>l.value=I),"error-id":c.value},null,8,["visible","error-id"]),D(ns,{visible:u.value,"onUpdate:visible":T[4]||(T[4]=I=>u.value=I),"error-id":c.value},null,8,["visible","error-id"])])}}}),cs=Ue(ls,[["__scopeId","data-v-8af2c153"]]),us={class:"error-container"},ds=$e({__name:"index",setup(t){const e=An(),n=H([]),o=H(0),r=H(!1),i=H(1),s=H(20),a=H(""),l=H("lastSeen_desc"),u=async()=>{try{r.value=!0,console.log("获取错误列表数据，参数:",{appId:e.appId,startTime:e.startTime,endTime:e.endTime,page:i.value,limit:s.value,sortBy:l.value,errorType:a.value});const d={appId:e.appId,startTime:e.startTime,endTime:e.endTime,page:i.value,limit:s.value,sortBy:l.value};a.value&&(d.errorType=a.value);const h=await io(e.appId,e.startTime,e.endTime,i.value,s.value,l.value);n.value=h.items,o.value=h.total,console.log("错误列表数据:",h)}catch(d){console.error("获取错误列表数据失败:",d),Ce.error("获取错误列表数据失败")}finally{r.value=!1}};Ie(()=>[e.appId,e.startTime,e.endTime],()=>{i.value=1,u()});const c=()=>{u()};return Sn(()=>{console.log("Error页面已挂载"),u()}),(d,h)=>(j(),ae("div",us,[h[5]||(h[5]=V("div",{class:"error-header"},[V("h2",{class:"page-title"},"错误监控"),V("p",{class:"page-description"},"查看和分析应用中的JavaScript错误")],-1)),D(vo,{"error-type":a.value,"onUpdate:errorType":h[0]||(h[0]=f=>a.value=f),"sort-by":l.value,"onUpdate:sortBy":h[1]||(h[1]=f=>l.value=f),onRefresh:c},null,8,["error-type","sort-by"]),D(cs,{data:n.value,total:o.value,loading:r.value,page:i.value,"page-size":s.value,"sort-by":l.value,"onUpdate:page":h[2]||(h[2]=f=>i.value=f),"onUpdate:pageSize":h[3]||(h[3]=f=>s.value=f),"onUpdate:sortBy":h[4]||(h[4]=f=>l.value=f),onRefresh:c},null,8,["data","total","loading","page","page-size","sort-by"])]))}}),vs=Ue(ds,[["__scopeId","data-v-40b191c9"]]);export{vs as default};
